"use strict";(self.webpackChunk_scribd_app_monolith=self.webpackChunk_scribd_app_monolith||[]).push([[7470],{89557:(t,e,s)=>{s.d(e,{A:()=>E});var r=s(94401),a=s(58315),n=s(68842),o=s(32775),i=s(26058);class h{constructor(t){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(t,e){if(!(0,r.ki)(t))return;if(this.shadowDoms.has(t))return;this.shadowDoms.add(t);const s=(0,a.YY)(Object.assign(Object.assign({},this.bypassOptions),{doc:e,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),t);this.restoreHandlers.push((()=>s.disconnect())),this.restoreHandlers.push((0,a.m0)(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:t,mirror:this.mirror}))),setTimeout((()=>{t.adoptedStyleSheets&&t.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(t.adoptedStyleSheets,this.mirror.getId(t.host)),this.restoreHandlers.push((0,a.CA)({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},t))}),0)}observeAttachShadow(t){t.contentWindow&&t.contentDocument&&this.patchAttachShadow(t.contentWindow.Element,t.contentDocument)}patchAttachShadow(t,e){const s=this;this.restoreHandlers.push((0,n.patch)(t.prototype,"attachShadow",(function(t){return function(r){const a=t.call(this,r);return this.shadowRoot&&(0,n.inDom)(this)&&s.addShadowRoot(this.shadowRoot,e),a}})))}reset(){this.restoreHandlers.forEach((t=>{try{t()}catch(t){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}var l=s(49526),c=s(26214);const d=new Map;const u=(t,e,s)=>{if(!t||!f(t,e)&&"object"!=typeof t)return;const r=function(t,e){let s=d.get(t);return s||(s=new Map,d.set(t,s)),s.has(e)||s.set(e,[]),s.get(e)}(s,t.constructor.name);let a=r.indexOf(t);return-1===a&&(a=r.length,r.push(t)),a};function p(t,e,s){if(t instanceof Array)return t.map((t=>p(t,e,s)));if(null===t)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray){return{rr_type:t.constructor.name,args:[Object.values(t)]}}if(t instanceof ArrayBuffer){return{rr_type:t.constructor.name,base64:(0,c.l)(t)}}if(t instanceof DataView){return{rr_type:t.constructor.name,args:[p(t.buffer,e,s),t.byteOffset,t.byteLength]}}if(t instanceof HTMLImageElement){const e=t.constructor.name,{src:s}=t;return{rr_type:e,src:s}}if(t instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:t.toDataURL()}}if(t instanceof ImageData){return{rr_type:t.constructor.name,args:[p(t.data,e,s),t.width,t.height]}}if(f(t,e)||"object"==typeof t){return{rr_type:t.constructor.name,index:u(t,e,s)}}return t}const m=(t,e,s)=>t.map((t=>p(t,e,s))),f=(t,e)=>{const s=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((t=>"function"==typeof e[t]));return Boolean(s.find((s=>t instanceof e[s])))};function g(t,e,s,r){const a=[];try{const o=(0,n.patch)(t.HTMLCanvasElement.prototype,"getContext",(function(t){return function(a,...o){if(!(0,n.isBlocked)(this,e,s,!0)){const t=function(t){return"experimental-webgl"===t?"webgl":t}(a);if("__context"in this||(this.__context=t),r&&["webgl","webgl2"].includes(t))if(o[0]&&"object"==typeof o[0]){const t=o[0];t.preserveDrawingBuffer||(t.preserveDrawingBuffer=!0)}else o.splice(0,1,{preserveDrawingBuffer:!0})}return t.apply(this,[a,...o])}}));a.push(o)}catch(t){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{a.forEach((t=>t()))}}function y(t,e,s,r,a,o,i){const h=[],l=Object.getOwnPropertyNames(t);for(const o of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(o))try{if("function"!=typeof t[o])continue;const l=(0,n.patch)(t,o,(function(t){return function(...h){const l=t.apply(this,h);if(u(l,i,this),"tagName"in this.canvas&&!(0,n.isBlocked)(this.canvas,r,a,!0)){const t=m(h,i,this),r={type:e,property:o,args:t};s(this.canvas,r)}return l}}));h.push(l)}catch(r){const a=(0,n.hookSetter)(t,o,{set(t){s(this.canvas,{type:e,property:o,args:[t],setter:!0})}});h.push(a)}return h}var b=s(90703);class S{reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}constructor(t){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(t,e)=>{!(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId)&&this.rafStamps.invokeId||(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(t)||this.pendingCanvasMutations.set(t,[]),this.pendingCanvasMutations.get(t).push(e)};const{sampling:e="all",win:s,blockClass:r,blockSelector:a,recordCanvas:n,dataURLOptions:o}=t;this.mutationCb=t.mutationCb,this.mirror=t.mirror,n&&"all"===e&&this.initCanvasMutationObserver(s,r,a),n&&"number"==typeof e&&this.initCanvasFPSObserver(e,s,r,a,{dataURLOptions:o})}initCanvasFPSObserver(t,e,s,r,a){const i=g(e,s,r,!0),h=new Map,c=new b.A;c.onmessage=t=>{const{id:e}=t.data;if(h.set(e,!1),!("base64"in t.data))return;const{base64:s,type:r,width:a,height:n}=t.data;this.mutationCb({id:e,type:o.Qv["2D"],commands:[{property:"clearRect",args:[0,0,a,n]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:s}],type:r}]},0,0]}]})};const d=1e3/t;let u,p=0;const m=t=>{p&&t-p<d||(p=t,(()=>{const t=[];return e.document.querySelectorAll("canvas").forEach((e=>{(0,n.isBlocked)(e,s,r,!0)||t.push(e)})),t})().forEach((t=>(0,l.s)(this,void 0,void 0,(function*(){var e;const s=this.mirror.getId(t);if(h.get(s))return;if(0===t.width||0===t.height)return;if(h.set(s,!0),["webgl","webgl2"].includes(t.__context)){const s=t.getContext(t.__context);!1===(null===(e=null==s?void 0:s.getContextAttributes())||void 0===e?void 0:e.preserveDrawingBuffer)&&s.clear(s.COLOR_BUFFER_BIT)}const r=yield createImageBitmap(t);c.postMessage({id:s,bitmap:r,width:t.width,height:t.height,dataURLOptions:a.dataURLOptions},[r])}))))),u=requestAnimationFrame(m)};u=requestAnimationFrame(m),this.resetObservers=()=>{i(),cancelAnimationFrame(u)}}initCanvasMutationObserver(t,e,s){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const r=g(t,e,s,!1),a=function(t,e,s,r){const a=[],i=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const h of i)try{if("function"!=typeof e.CanvasRenderingContext2D.prototype[h])continue;const i=(0,n.patch)(e.CanvasRenderingContext2D.prototype,h,(function(a){return function(...i){return(0,n.isBlocked)(this.canvas,s,r,!0)||setTimeout((()=>{const s=m(i,e,this);t(this.canvas,{type:o.Qv["2D"],property:h,args:s})}),0),a.apply(this,i)}}));a.push(i)}catch(s){const r=(0,n.hookSetter)(e.CanvasRenderingContext2D.prototype,h,{set(e){t(this.canvas,{type:o.Qv["2D"],property:h,args:[e],setter:!0})}});a.push(r)}return()=>{a.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,s),i=function(t,e,s,r){const a=[];return a.push(...y(e.WebGLRenderingContext.prototype,o.Qv.WebGL,t,s,r,0,e)),void 0!==e.WebGL2RenderingContext&&a.push(...y(e.WebGL2RenderingContext.prototype,o.Qv.WebGL2,t,s,r,0,e)),()=>{a.forEach((t=>t()))}}(this.processMutation.bind(this),t,e,s,this.mirror);this.resetObservers=()=>{r(),a(),i()}}startPendingCanvasMutationFlusher(){requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}startRAFTimestamping(){const t=e=>{this.rafStamps.latestId=e,requestAnimationFrame(t)};requestAnimationFrame(t)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach(((t,e)=>{const s=this.mirror.getId(e);this.flushPendingCanvasMutationFor(e,s)})),requestAnimationFrame((()=>this.flushPendingCanvasMutations()))}flushPendingCanvasMutationFor(t,e){if(this.frozen||this.locked)return;const s=this.pendingCanvasMutations.get(t);if(!s||-1===e)return;const r=s.map((t=>(0,l.T)(t,["type"]))),{type:a}=s[0];this.mutationCb({id:e,type:a,commands:r}),this.pendingCanvasMutations.delete(t)}}class v{constructor(t){this.trackedLinkElements=new WeakSet,this.styleMirror=new n.StyleSheetMirror,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}attachLinkElement(t,e){"_cssText"in e.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:e.id,attributes:e.attributes}]}),this.trackLinkElement(t)}trackLinkElement(t){this.trackedLinkElements.has(t)||(this.trackedLinkElements.add(t),this.trackStylesheetInLinkElement(t))}adoptStyleSheets(t,e){if(0===t.length)return;const s={id:e,styleIds:[]},a=[];for(const e of t){let t;this.styleMirror.has(e)?t=this.styleMirror.getId(e):(t=this.styleMirror.add(e),a.push({styleId:t,rules:Array.from(e.rules||CSSRule,((t,e)=>({rule:(0,r.Ev)(t),index:e})))})),s.styleIds.push(t)}a.length>0&&(s.styles=a),this.adoptedStyleSheetCb(s)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(t){}}class k{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame((()=>{this.clear(),this.loop&&this.periodicallyClear()}))}inOtherBuffer(t,e){const s=this.nodeMap.get(t);return s&&Array.from(s).some((t=>t!==e))}add(t,e){this.nodeMap.set(t,(this.nodeMap.get(t)||new Set).add(e))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}var C,w=s(16062);let M,I,x,O=!1;try{if(2!==Array.from([1],(t=>2*t))[0]){const t=document.createElement("iframe");document.body.appendChild(t),Array.from=(null===(C=t.contentWindow)||void 0===C?void 0:C.Array.from)||Array.from,document.body.removeChild(t)}}catch(t){console.debug("Unable to override Array.from",t)}const A=(0,r.cY)();function E(t={}){const{emit:e,checkoutEveryNms:s,checkoutEveryNth:l,blockClass:c="rr-block",blockSelector:d=null,ignoreClass:u="rr-ignore",ignoreSelector:p=null,maskTextClass:m="rr-mask",maskTextSelector:f=null,inlineStylesheet:g=!0,maskAllInputs:y,maskInputOptions:b,slimDOMOptions:C,maskInputFn:E,maskTextFn:L,hooks:D,packFn:F,sampling:N={},dataURLOptions:_={},mousemoveWait:T,recordDOM:R=!0,recordCanvas:B=!1,recordCrossOriginIframes:j=!1,recordAfter:W=("DOMContentLoaded"===t.recordAfter?t.recordAfter:"load"),userTriggeredOnInput:z=!1,collectFonts:P=!1,inlineImages:H=!1,plugins:U,keepIframeSrcFn:G=()=>!1,ignoreCSSAttributes:V=new Set([]),errorHandler:q}=t;(0,w.s)(q);const Q=!j||window.parent===window;let X=!1;if(!Q)try{window.parent.document&&(X=!1)}catch(t){X=!0}if(Q&&!e)throw new Error("emit function is required");void 0!==T&&void 0===N.mousemove&&(N.mousemove=T),A.reset();const J=!0===y?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==b?b:{password:!0},Y=!0===C||"all"===C?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===C,headMetaDescKeywords:"all"===C}:C||{};let $;(0,n.polyfill)();let K=0;const Z=t=>{for(const e of U||[])e.eventProcessor&&(t=e.eventProcessor(t));return F&&!X&&(t=F(t)),t};M=(t,r)=>{var i;const h=t;if(h.timestamp=(0,n.nowTimestamp)(),!(null===(i=a.Hj[0])||void 0===i?void 0:i.isFrozen())||h.type===o.Bx.FullSnapshot||h.type===o.Bx.IncrementalSnapshot&&h.data.source===o.Cj.Mutation||a.Hj.forEach((t=>t.unfreeze())),Q)null==e||e(Z(h),r);else if(X){const t={type:"rrweb",event:Z(h),origin:window.location.origin,isCheckout:r};window.parent.postMessage(t,"*")}if(h.type===o.Bx.FullSnapshot)$=h,K=0;else if(h.type===o.Bx.IncrementalSnapshot){if(h.data.source===o.Cj.Mutation&&h.data.isAttachIframe)return;K++;const t=l&&K>=l,e=s&&h.timestamp-$.timestamp>s;(t||e)&&I(!0)}};const tt=t=>{M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.Mutation},t)})},et=t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.Scroll},t)}),st=t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.CanvasMutation},t)}),rt=new v({mutationCb:tt,adoptedStyleSheetCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.AdoptedStyleSheet},t)})}),at=new i.O({mirror:A,mutationCb:tt,stylesheetManager:rt,recordCrossOriginIframes:j,wrappedEmit:M});for(const t of U||[])t.getMirror&&t.getMirror({nodeMirror:A,crossOriginIframeMirror:at.crossOriginIframeMirror,crossOriginIframeStyleMirror:at.crossOriginIframeStyleMirror});const nt=new k;x=new S({recordCanvas:B,mutationCb:st,win:window,blockClass:c,blockSelector:d,mirror:A,sampling:N.canvas,dataURLOptions:_});const ot=new h({mutationCb:tt,scrollCb:et,bypassOptions:{blockClass:c,blockSelector:d,maskTextClass:m,maskTextSelector:f,inlineStylesheet:g,maskInputOptions:J,dataURLOptions:_,maskTextFn:L,maskInputFn:E,recordCanvas:B,inlineImages:H,sampling:N,slimDOMOptions:Y,iframeManager:at,stylesheetManager:rt,canvasManager:x,keepIframeSrcFn:G,processedNodeManager:nt},mirror:A});I=(t=!1)=>{if(!R)return;M({type:o.Bx.Meta,data:{href:window.location.href,width:(0,n.getWindowWidth)(),height:(0,n.getWindowHeight)()}},t),rt.reset(),ot.init(),a.Hj.forEach((t=>t.lock()));const e=(0,r.P9)(document,{mirror:A,blockClass:c,blockSelector:d,maskTextClass:m,maskTextSelector:f,inlineStylesheet:g,maskAllInputs:J,maskTextFn:L,slimDOM:Y,dataURLOptions:_,recordCanvas:B,inlineImages:H,onSerialize:t=>{(0,n.isSerializedIframe)(t,A)&&at.addIframe(t),(0,n.isSerializedStylesheet)(t,A)&&rt.trackLinkElement(t),(0,n.hasShadowRoot)(t)&&ot.addShadowRoot(t.shadowRoot,document)},onIframeLoad:(t,e)=>{at.attachIframe(t,e),ot.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{rt.attachLinkElement(t,e)},keepIframeSrcFn:G});if(!e)return console.warn("Failed to snapshot the document");M({type:o.Bx.FullSnapshot,data:{node:e,initialOffset:(0,n.getWindowScroll)(window)}},t),a.Hj.forEach((t=>t.unlock())),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&rt.adoptStyleSheets(document.adoptedStyleSheets,A.getId(document))};try{const t=[],e=t=>{var e;return(0,w.l0)(a.eZ)({mutationCb:tt,mousemoveCb:(t,e)=>M({type:o.Bx.IncrementalSnapshot,data:{source:e,positions:t}}),mouseInteractionCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.MouseInteraction},t)}),scrollCb:et,viewportResizeCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.ViewportResize},t)}),inputCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.Input},t)}),mediaInteractionCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.MediaInteraction},t)}),styleSheetRuleCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.StyleSheetRule},t)}),styleDeclarationCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.StyleDeclaration},t)}),canvasMutationCb:st,fontCb:t=>M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.Font},t)}),selectionCb:t=>{M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.Selection},t)})},customElementCb:t=>{M({type:o.Bx.IncrementalSnapshot,data:Object.assign({source:o.Cj.CustomElement},t)})},blockClass:c,ignoreClass:u,ignoreSelector:p,maskTextClass:m,maskTextSelector:f,maskInputOptions:J,inlineStylesheet:g,sampling:N,recordDOM:R,recordCanvas:B,inlineImages:H,userTriggeredOnInput:z,collectFonts:P,doc:t,maskInputFn:E,maskTextFn:L,keepIframeSrcFn:G,blockSelector:d,slimDOMOptions:Y,dataURLOptions:_,mirror:A,iframeManager:at,stylesheetManager:rt,shadowDomManager:ot,processedNodeManager:nt,canvasManager:x,ignoreCSSAttributes:V,plugins:(null===(e=null==U?void 0:U.filter((t=>t.observer)))||void 0===e?void 0:e.map((t=>({observer:t.observer,options:t.options,callback:e=>M({type:o.Bx.Plugin,data:{plugin:t.name,payload:e}})}))))||[]},D)};at.addLoadListener((s=>{try{t.push(e(s.contentDocument))}catch(t){console.warn(t)}}));const s=()=>{I(),t.push(e(document)),O=!0};return"interactive"===document.readyState||"complete"===document.readyState?s():(t.push((0,n.on)("DOMContentLoaded",(()=>{M({type:o.Bx.DomContentLoaded,data:{}}),"DOMContentLoaded"===W&&s()}))),t.push((0,n.on)("load",(()=>{M({type:o.Bx.Load,data:{}}),"load"===W&&s()}),window))),()=>{t.forEach((t=>t())),nt.destroy(),O=!1,(0,w.vd)()}}catch(t){console.warn(t)}}E.addCustomEvent=(t,e)=>{if(!O)throw new Error("please add custom event after start recording");M({type:o.Bx.Custom,data:{tag:t,payload:e}})},E.freezePage=()=>{a.Hj.forEach((t=>t.freeze()))},E.takeFullSnapshot=t=>{if(!O)throw new Error("please take full snapshot after start recording");I(t)},E.mirror=A},4794:(t,e,s)=>{s.d(e,{A:()=>h});var r=s(94401),a=s(68842);function n(t){return"__ln"in t}class o{constructor(){this.length=0,this.head=null,this.tail=null}get(t){if(t>=this.length)throw new Error("Position outside of list range");let e=this.head;for(let s=0;s<t;s++)e=(null==e?void 0:e.next)||null;return e}addNode(t){const e={value:t,previous:null,next:null};if(t.__ln=e,t.previousSibling&&n(t.previousSibling)){const s=t.previousSibling.__ln.next;e.next=s,e.previous=t.previousSibling.__ln,t.previousSibling.__ln.next=e,s&&(s.previous=e)}else if(t.nextSibling&&n(t.nextSibling)&&t.nextSibling.__ln.previous){const s=t.nextSibling.__ln.previous;e.previous=s,e.next=t.nextSibling.__ln,t.nextSibling.__ln.previous=e,s&&(s.next=e)}else this.head&&(this.head.previous=e),e.next=this.head,this.head=e;null===e.next&&(this.tail=e),this.length++}removeNode(t){const e=t.__ln;this.head&&(e.previous?(e.previous.next=e.next,e.next?e.next.previous=e.previous:this.tail=e.previous):(this.head=e.next,this.head?this.head.previous=null:this.tail=null),t.__ln&&delete t.__ln,this.length--)}}const i=(t,e)=>`${t}@${e}`;class h{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=t=>{t.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const t=[],e=new Set,s=new o,n=t=>{let e=t,s=r.ge;for(;s===r.ge;)e=e&&e.nextSibling,s=e&&this.mirror.getId(e);return s},i=o=>{if(!o.parentNode||!(0,a.inDom)(o)||"TEXTAREA"===o.parentNode.tagName)return;const i=(0,r.Ng)(o.parentNode)?this.mirror.getId((0,a.getShadowHost)(o)):this.mirror.getId(o.parentNode),h=n(o);if(-1===i||-1===h)return s.addNode(o);const l=(0,r.AL)(o,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:t=>{(0,a.isSerializedIframe)(t,this.mirror)&&this.iframeManager.addIframe(t),(0,a.isSerializedStylesheet)(t,this.mirror)&&this.stylesheetManager.trackLinkElement(t),(0,a.hasShadowRoot)(o)&&this.shadowDomManager.addShadowRoot(o.shadowRoot,this.doc)},onIframeLoad:(t,e)=>{this.iframeManager.attachIframe(t,e),this.shadowDomManager.observeAttachShadow(t)},onStylesheetLoad:(t,e)=>{this.stylesheetManager.attachLinkElement(t,e)}});l&&(t.push({parentId:i,nextId:h,node:l}),e.add(l.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const t of this.movedSet)c(this.removes,t,this.mirror)&&!this.movedSet.has(t.parentNode)||i(t);for(const t of this.addedSet)u(this.droppedSet,t)||c(this.removes,t,this.mirror)?u(this.movedSet,t)?i(t):this.droppedSet.add(t):i(t);let h=null;for(;s.length;){let t=null;if(h){const e=this.mirror.getId(h.value.parentNode),s=n(h.value);-1!==e&&-1!==s&&(t=h)}if(!t){let e=s.tail;for(;e;){const s=e;if(e=e.previous,s){const e=this.mirror.getId(s.value.parentNode);if(-1===n(s.value))continue;if(-1!==e){t=s;break}{const e=s.value;if(e.parentNode&&e.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const r=e.parentNode.host;if(-1!==this.mirror.getId(r)){t=s;break}}}}}}if(!t){for(;s.head;)s.removeNode(s.head.value);break}h=t.previous,s.removeNode(t.value),i(t.value)}const l={texts:this.texts.map((t=>{const e=t.node;return e.parentNode&&"TEXTAREA"===e.parentNode.tagName&&this.genTextAreaValueMutation(e.parentNode),{id:this.mirror.getId(e),value:t.value}})).filter((t=>!e.has(t.id))).filter((t=>this.mirror.has(t.id))),attributes:this.attributes.map((t=>{const{attributes:e}=t;if("string"==typeof e.style){const s=JSON.stringify(t.styleDiff),r=JSON.stringify(t._unchangedStyles);s.length<e.style.length&&(s+r).split("var(").length===e.style.split("var(").length&&(e.style=t.styleDiff)}return{id:this.mirror.getId(t.node),attributes:e}})).filter((t=>!e.has(t.id))).filter((t=>this.mirror.has(t.id))),removes:this.removes,adds:t};(l.texts.length||l.attributes.length||l.removes.length||l.adds.length)&&(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(l))},this.genTextAreaValueMutation=t=>{let e=this.attributeMap.get(t);e||(e={node:t,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(e),this.attributeMap.set(t,e)),e.attributes.value=Array.from(t.childNodes,(t=>t.textContent||"")).join("")},this.processMutation=t=>{if(!(0,a.isIgnored)(t.target,this.mirror))switch(t.type){case"characterData":{const e=t.target.textContent;(0,a.isBlocked)(t.target,this.blockClass,this.blockSelector,!1)||e===t.oldValue||this.texts.push({value:(0,r.E3)(t.target,this.maskTextClass,this.maskTextSelector,!0)&&e?this.maskTextFn?this.maskTextFn(e,(0,a.closestElementOfNode)(t.target)):e.replace(/[\S]/g,"*"):e,node:t.target});break}case"attributes":{const e=t.target;let s=t.attributeName,n=t.target.getAttribute(s);if("value"===s){const t=(0,r.B6)(e);n=(0,r.iE)({element:e,maskInputOptions:this.maskInputOptions,tagName:e.tagName,type:t,value:n,maskInputFn:this.maskInputFn})}if((0,a.isBlocked)(t.target,this.blockClass,this.blockSelector,!1)||n===t.oldValue)return;let o=this.attributeMap.get(t.target);if("IFRAME"===e.tagName&&"src"===s&&!this.keepIframeSrcFn(n)){if(e.contentDocument)return;s="rr_src"}if(o||(o={node:t.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(o),this.attributeMap.set(t.target,o)),"type"===s&&"INPUT"===e.tagName&&"password"===(t.oldValue||"").toLowerCase()&&e.setAttribute("data-rr-is-password","true"),!(0,r.DD)(e.tagName,s)&&(o.attributes[s]=(0,r.J)(this.doc,(0,r.PX)(e.tagName),(0,r.PX)(s),n),"style"===s)){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch(t){this.unattachedDoc=this.doc}const s=this.unattachedDoc.createElement("span");t.oldValue&&s.setAttribute("style",t.oldValue);for(const t of Array.from(e.style)){const r=e.style.getPropertyValue(t),a=e.style.getPropertyPriority(t);r!==s.style.getPropertyValue(t)||a!==s.style.getPropertyPriority(t)?o.styleDiff[t]=""===a?r:[r,a]:o._unchangedStyles[t]=[r,a]}for(const t of Array.from(s.style))""===e.style.getPropertyValue(t)&&(o.styleDiff[t]=!1)}break}case"childList":if((0,a.isBlocked)(t.target,this.blockClass,this.blockSelector,!0))return;if("TEXTAREA"===t.target.tagName)return void this.genTextAreaValueMutation(t.target);t.addedNodes.forEach((e=>this.genAdds(e,t.target))),t.removedNodes.forEach((e=>{const s=this.mirror.getId(e),n=(0,r.Ng)(t.target)?this.mirror.getId(t.target.host):this.mirror.getId(t.target);(0,a.isBlocked)(t.target,this.blockClass,this.blockSelector,!1)||(0,a.isIgnored)(e,this.mirror)||!(0,a.isSerialized)(e,this.mirror)||(this.addedSet.has(e)?(l(this.addedSet,e),this.droppedSet.add(e)):this.addedSet.has(t.target)&&-1===s||(0,a.isAncestorRemoved)(t.target,this.mirror)||(this.movedSet.has(e)&&this.movedMap[i(s,n)]?l(this.movedSet,e):this.removes.push({parentId:n,id:s,isShadow:!(!(0,r.Ng)(t.target)||!(0,r.ki)(t.target))||void 0})),this.mapRemoves.push(e))}))}},this.genAdds=(t,e)=>{if(!this.processedNodeManager.inOtherBuffer(t,this)&&!this.addedSet.has(t)&&!this.movedSet.has(t)){if(this.mirror.hasNode(t)){if((0,a.isIgnored)(t,this.mirror))return;this.movedSet.add(t);let s=null;e&&this.mirror.hasNode(e)&&(s=this.mirror.getId(e)),s&&-1!==s&&(this.movedMap[i(this.mirror.getId(t),s)]=!0)}else this.addedSet.add(t),this.droppedSet.delete(t);(0,a.isBlocked)(t,this.blockClass,this.blockSelector,!1)||(t.childNodes.forEach((t=>this.genAdds(t))),(0,a.hasShadowRoot)(t)&&t.shadowRoot.childNodes.forEach((e=>{this.processedNodeManager.add(e,this),this.genAdds(e,t)})))}}}init(t){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((e=>{this[e]=t[e]}))}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function l(t,e){t.delete(e),e.childNodes.forEach((e=>l(t,e)))}function c(t,e,s){return 0!==t.length&&d(t,e,s)}function d(t,e,s){const{parentNode:r}=e;if(!r)return!1;const a=s.getId(r);return!!t.some((t=>t.id===a))||d(t,r,s)}function u(t,e){return 0!==t.size&&p(t,e)}function p(t,e){const{parentNode:s}=e;return!!s&&(!!t.has(s)||p(t,s))}}}]);
//# sourceMappingURL=https://www.scribd.com/webpack/monolith/7470.9c73ee8158b2c8bfd388.js.map