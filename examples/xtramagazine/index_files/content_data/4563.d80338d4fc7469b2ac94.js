"use strict";(self.webpackChunk_scribd_app_monolith=self.webpackChunk_scribd_app_monolith||[]).push([[4563],{36699:(e,t,r)=>{r.r(t),r.d(t,{EventType:()=>b.Bx,IncrementalSource:()=>b.Cj,MouseInteractions:()=>b.T7,PLUGIN_NAME:()=>w,Replayer:()=>R.B,ReplayerEvents:()=>b.Y$,addCustomEvent:()=>a,canvasMutation:()=>x.A,freezePage:()=>o,getRecordConsolePlugin:()=>N,getReplayConsolePlugin:()=>L,mirror:()=>d._mirror,pack:()=>c,record:()=>n.A,unpack:()=>l,utils:()=>d});var n=r(89557);const{addCustomEvent:a}=n.A,{freezePage:o}=n.A;var s=r(17958);const i="v1",c=e=>{const t=Object.assign(Object.assign({},e),{v:i});return(0,s.he)((0,s.$)((0,s._u)(JSON.stringify(t))),!0)},l=e=>{if("string"!=typeof e)return e;try{const t=JSON.parse(e);if(t.timestamp)return t}catch(e){}try{const t=JSON.parse((0,s.he)((0,s.a8)((0,s._u)(e,!0))));if(t.v===i)return t;throw new Error(`These events were packed with packer ${t.v} which is incompatible with current packer ${i}.`)}catch(e){throw console.error(e),new Error("Unknown data format.")}};var d=r(68842);class p{constructor(e){this.fileName=e.fileName||"",this.functionName=e.functionName||"",this.lineNumber=e.lineNumber,this.columnNumber=e.columnNumber}toString(){const e=this.lineNumber||"",t=this.columnNumber||"";return this.functionName?`${this.functionName} (${this.fileName}:${e}:${t})`:`${this.fileName}:${e}:${t}`}}const u=/(^|@)\S+:\d+/,h=/^\s*at .*(\S+:\d+|\(native\))/m,m=/^(eval@)?(\[native code])?$/,f={parse:function(e){return e?void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match(h)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):(console.warn("[console-record-plugin]: Failed to parse error object:",e),[]):[]},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];const t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));if(!t)throw new Error(`Cannot parse given url: ${e}`);return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(h)}),this).map((function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""));let t=e.replace(/^\s+/,"").replace(/\(eval code/g,"(");const r=t.match(/ (\((.+):(\d+):(\d+)\)$)/);t=r?t.replace(r[0],""):t;const n=t.split(/\s+/).slice(1),a=this.extractLocation(r?r[1]:n.pop()),o=n.join(" ")||void 0,s=["eval","<anonymous>"].indexOf(a[0])>-1?void 0:a[0];return new p({functionName:o,fileName:s,lineNumber:a[1],columnNumber:a[2]})}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(m)}),this).map((function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new p({functionName:e});{const t=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=e.match(t),n=r&&r[1]?r[1]:void 0,a=this.extractLocation(e.replace(t,""));return new p({functionName:n,fileName:a[0],lineNumber:a[1],columnNumber:a[2]})}}),this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){const t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),n=[];for(let e=2,a=r.length;e<a;e+=2){const a=t.exec(r[e]);a&&n.push(new p({fileName:a[2],lineNumber:parseFloat(a[1])}))}return n},parseOpera10:function(e){const t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),n=[];for(let e=0,a=r.length;e<a;e+=2){const a=t.exec(r[e]);a&&n.push(new p({functionName:a[3]||void 0,fileName:a[2],lineNumber:parseFloat(a[1])}))}return n},parseOpera11:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(u)&&!e.match(/^Error created at/)}),this).map((function(e){const t=e.split("@"),r=this.extractLocation(t.pop()),n=(t.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;return new p({functionName:n,fileName:r[0],lineNumber:r[1],columnNumber:r[2]})}),this)}};function g(e){if(!e||!e.outerHTML)return"";let t="";for(;e.parentElement;){let r=e.localName;if(!r)break;r=r.toLowerCase();const n=e.parentElement,a=[];if(n.children&&n.children.length>0)for(let e=0;e<n.children.length;e++){const t=n.children[e];t.localName&&t.localName.toLowerCase&&t.localName.toLowerCase()===r&&a.push(t)}a.length>1&&(r+=`:eq(${a.indexOf(e)})`),t=r+(t?">"+t:""),e=n}return t}function I(e){return"[object Object]"===Object.prototype.toString.call(e)}function v(e,t){if(0===t)return!0;const r=Object.keys(e);for(const n of r)if(I(e[n])&&v(e[n],t-1))return!0;return!1}function y(e,t){const r={numOfKeysLimit:50,depthOfLimit:4};Object.assign(r,t);const n=[],a=[];return JSON.stringify(e,(function(e,t){if(n.length>0){const r=n.indexOf(this);~r?n.splice(r+1):n.push(this),~r?a.splice(r,1/0,e):a.push(e),~n.indexOf(t)&&(t=n[0]===t?"[Circular ~]":"[Circular ~."+a.slice(0,n.indexOf(t)).join(".")+"]")}else n.push(t);if(null===t)return t;if(void 0===t)return"undefined";if(function(e){if(I(e)&&Object.keys(e).length>r.numOfKeysLimit)return!0;if("function"==typeof e)return!0;if(I(e)&&v(e,r.depthOfLimit))return!0;return!1}(t))return function(e){let t=e.toString();r.stringLengthLimit&&t.length>r.stringLengthLimit&&(t=`${t.slice(0,r.stringLengthLimit)}...`);return t}(t);if("bigint"==typeof t)return t.toString()+"n";if(t instanceof Event){const e={};for(const r in t){const n=t[r];Array.isArray(n)?e[r]=g(n.length?n[0]:null):e[r]=n}return e}return t instanceof Node?t instanceof HTMLElement?t?t.outerHTML:"":t.nodeName:t instanceof Error?t.stack?t.stack+"\nEnd of stack for Error object":t.name+": "+t.message:t}))}const O={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],lengthThreshold:1e3,logger:"console"};function M(e,t,r){const n=r?Object.assign({},O,r):O,a=n.logger;if(!a)return()=>{};let o;o="string"==typeof a?t[a]:a;let s=0,i=!1;const c=[];if(n.level.includes("error")){const r=t=>{const r=t.message,a=t.error,o=f.parse(a).map((e=>e.toString())),s=[y(r,n.stringifyOptions)];e({level:"error",trace:o,payload:s})};t.addEventListener("error",r),c.push((()=>{t.removeEventListener("error",r)}));const a=t=>{let r,a;t.reason instanceof Error?(r=t.reason,a=[y(`Uncaught (in promise) ${r.name}: ${r.message}`,n.stringifyOptions)]):(r=new Error,a=[y("Uncaught (in promise)",n.stringifyOptions),y(t.reason,n.stringifyOptions)]);const o=f.parse(r).map((e=>e.toString()));e({level:"error",trace:o,payload:a})};t.addEventListener("unhandledrejection",a),c.push((()=>{t.removeEventListener("unhandledrejection",a)}))}for(const e of n.level)c.push(l(o,e));return()=>{c.forEach((e=>e()))};function l(t,r){return t[r]?(0,d.patch)(t,r,(t=>(...a)=>{if(t.apply(this,a),!i){i=!0;try{const t=f.parse(new Error).map((e=>e.toString())).splice(1),o=a.map((e=>y(e,n.stringifyOptions)));s++,s<n.lengthThreshold?e({level:r,trace:t,payload:o}):s===n.lengthThreshold&&e({level:"warn",trace:[],payload:[y("The number of log records reached the threshold.")]})}catch(e){t("rrweb logger error:",e,...a)}finally{i=!1}}})):()=>{}}}const w="rrweb/console@1",N=e=>({name:w,observer:M,options:e});var b=r(32775);const S="__rrweb_original__",C={level:["assert","clear","count","countReset","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","table","time","timeEnd","timeLog","trace","warn"],replayLogger:void 0};class E{constructor(e){this.config=Object.assign(C,e)}getConsoleLogger(){const e={};for(const t of this.config.level)e[t]="trace"===t?e=>{(console.log[S]?console.log[S]:console.log)(...e.payload.map((e=>JSON.parse(e))),this.formatMessage(e))}:e=>{(console[t][S]?console[t][S]:console[t])(...e.payload.map((e=>JSON.parse(e))),this.formatMessage(e))};return e}formatMessage(e){if(0===e.trace.length)return"";const t="\n\tat ";let r=t;return r+=e.trace.join(t),r}}const L=e=>{const t=(null==e?void 0:e.replayLogger)||new E(e).getConsoleLogger();return{handler(e,r,n){let a=null;if(e.type===b.Bx.IncrementalSnapshot&&e.data.source===b.Cj.Log?a=e.data:e.type===b.Bx.Plugin&&e.data.plugin===w&&(a=e.data.payload),a)try{"function"==typeof t[a.level]&&t[a.level](a)}catch(e){n.replayer.config.showWarning&&console.warn(e)}}}};var x=r(42558),R=r(15327)},16062:(e,t,r)=>{let n;function a(e){n=e}function o(){n=void 0}r.d(t,{l0:()=>s,s:()=>a,vd:()=>o});const s=e=>{if(!n)return e;return(...t)=>{try{return e(...t)}catch(e){if(n&&!0===n(e))return;throw e}}}},26058:(e,t,r)=>{r.d(t,{O:()=>s});var n=r(94401);class a{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,t,r,n){const a=r||this.getIdToRemoteIdMap(e),o=n||this.getRemoteIdToIdMap(e);let s=a.get(t);return s||(s=this.generateIdFn(),a.set(t,s),o.set(s,t)),s}getIds(e,t){const r=this.getIdToRemoteIdMap(e),n=this.getRemoteIdToIdMap(e);return t.map((t=>this.getId(e,t,r,n)))}getRemoteId(e,t,r){const n=r||this.getRemoteIdToIdMap(e);if("number"!=typeof t)return t;const a=n.get(t);return a||-1}getRemoteIds(e,t){const r=this.getRemoteIdToIdMap(e);return t.map((t=>this.getRemoteId(e,t,r)))}reset(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}getRemoteIdToIdMap(e){let t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}var o=r(32775);class s{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new a(n.aq),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new a(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,t){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(r=this.loadListener)||void 0===r||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const t=e;if("rrweb"!==t.data.type||t.origin!==t.data.origin)return;if(!e.source)return;const r=this.crossOriginIframeMap.get(e.source);if(!r)return;const n=this.transformCrossOriginEvent(r,t.data.event);n&&this.wrappedEmit(n,t.data.isCheckout)}transformCrossOriginEvent(e,t){var r;switch(t.type){case o.Bx.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);const r=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,r),this.patchRootIdOnNode(t.data.node,r),{timestamp:t.timestamp,type:o.Bx.IncrementalSnapshot,data:{source:o.Cj.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case o.Bx.Meta:case o.Bx.Load:case o.Bx.DomContentLoaded:return!1;case o.Bx.Plugin:return t;case o.Bx.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case o.Bx.IncrementalSnapshot:switch(t.data.source){case o.Cj.Mutation:return t.data.adds.forEach((t=>{this.replaceIds(t,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(t.node,e);const r=this.crossOriginIframeRootIdMap.get(e);r&&this.patchRootIdOnNode(t.node,r)})),t.data.removes.forEach((t=>{this.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((t=>{this.replaceIds(t,e,["id"])})),t.data.texts.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case o.Cj.Drag:case o.Cj.TouchMove:case o.Cj.MouseMove:return t.data.positions.forEach((t=>{this.replaceIds(t,e,["id"])})),t;case o.Cj.ViewportResize:return!1;case o.Cj.MediaInteraction:case o.Cj.MouseInteraction:case o.Cj.Scroll:case o.Cj.CanvasMutation:case o.Cj.Input:return this.replaceIds(t.data,e,["id"]),t;case o.Cj.StyleSheetRule:case o.Cj.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case o.Cj.Font:return t;case o.Cj.Selection:return t.data.ranges.forEach((t=>{this.replaceIds(t,e,["start","end"])})),t;case o.Cj.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(r=t.data.styles)||void 0===r||r.forEach((t=>{this.replaceStyleIds(t,e,["styleId"])})),t}}return!1}replace(e,t,r,n){for(const a of n)(Array.isArray(t[a])||"number"==typeof t[a])&&(Array.isArray(t[a])?t[a]=e.getIds(r,t[a]):t[a]=e.getId(r,t[a]));return t}replaceIds(e,t,r){return this.replace(this.crossOriginIframeMirror,e,t,r)}replaceStyleIds(e,t,r){return this.replace(this.crossOriginIframeStyleMirror,e,t,r)}replaceIdOnNode(e,t){this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((e=>{this.replaceIdOnNode(e,t)}))}patchRootIdOnNode(e,t){e.type===n.Z6.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((e=>{this.patchRootIdOnNode(e,t)}))}}}}]);
//# sourceMappingURL=https://www.scribd.com/webpack/monolith/4563.d80338d4fc7469b2ac94.js.map