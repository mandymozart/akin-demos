"use strict";(self.webpackChunk_scribd_app_monolith=self.webpackChunk_scribd_app_monolith||[]).push([[7438],{59132:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(77151);function r(e){return{type:n.A.SET_IS_HAMBURGER_MENU_OPEN,isOpen:e}}},98625:(e,t,s)=>{s.d(t,{A:()=>r});var n=s(77151);function r(e){return{type:n.A.SET_MEGAMENU_TOP_BAR_VISIBLE,isMegamenuTopBarVisible:e}}},77151:(e,t,s)=>{s.d(t,{A:()=>n});const n={SET_IS_HAMBURGER_MENU_OPEN:"currentPage/SET_IS_HAMBURGER_MENU_OPEN",SET_MEGAMENU_PRIMARY_NAV_VISIBLE:"SET_MEGAMENU_PRIMARY_NAV_VISIBLE",SET_MEGAMENU_TOP_BAR_VISIBLE:"SET_MEGAMENU_TOP_BAR_VISIBLE",SET_SCROLL_DIRECTION:"currentPage/SET_SCROLL_DIRECTION",SET_SELECTED_TAB:"currentPage/SET_SELECTED_TAB"}},55231:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(55425),r=s(13468);function a(e={}){return(0,r.A)({name:n.MODAL_NAMES.SCRIBD_LANGUAGE_PICKER,isDismissable:!0,fitWidth:!1,...e})}},9079:(e,t,s)=>{s.d(t,{Dx:()=>I,rI:()=>M});var n=s(98158),r=s(39067),a=s.n(r),i=s(32720),o=s.n(i),u=s(22355),l=s.n(u),h=s(45250),c=s(81716),d=s(55572),g=s(49634),m=s(11865),p=s(69740),_=s(75914),S=s(27067),y=s(55425),f=s(78082),v=s(89575),b=e=>{var{buttonStyle:t,children:s,className:n,disabled:r,menuIsOpen:a,onClick:i,onMouseEnter:u,onMouseLeave:h,nodeRef:c,useTextHandle:d}=e,m={"aria-expanded":a,"aria-haspopup":"true",buttonStyle:t,className:l()("menu_handle",n),disabled:r,href:"#",nodeRef:c,onClick:i,onMouseEnter:u,onMouseLeave:h};return d?o().createElement(g.QW,m,s):o().cloneElement(s,(0,p.A)((0,p.A)({},m),{},{isSelected:a}))};b.propTypes={buttonStyle:a().string,children:a().any,className:a().string,disabled:a().bool,menuIsOpen:a().bool,nodeRef:a().oneOfType([a().func,a().shape({current:a().any})]),onClick:a().func,onMouseEnter:a().func,onMouseLeave:a().func,useTextHandle:a().bool.isRequired},b.defaultProps={buttonStyle:g.mj.DEFAULT,className:null,disabled:!1,menuIsOpen:!1,onClick:m.noop,onMouseEnter:m.noop,onMouseLeave:m.noop};var I={BOTTOM:"bottom",BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight",TOP:"top"},E={wrapper:"MenuItems-module_wrapper__y6cjo",bottom:"MenuItems-module_bottom__el08f",bottomLeft:"MenuItems-module_bottomLeft__FF-WY",bottomRight:"MenuItems-module_bottomRight__YhCd-",closeButton:"MenuItems-module_closeButton__ZAyQt",enter:"MenuItems-module_enter__vWntV",enterActive:"MenuItems-module_enterActive__siJBE",enterDone:"MenuItems-module_enterDone__0krvl",exit:"MenuItems-module_exit__7RHpQ",exitActive:"MenuItems-module_exitActive__9vh7o",exitDone:"MenuItems-module_exitDone__0t4vV",isOpen:"MenuItems-module_isOpen__nxqbR",top:"MenuItems-module_top__2bxjj"},T=e=>{var{children:t,className:s,handleClose:n,isOpen:r,nodeRef:a,position:i,transition:u,style:h}=e,c=u?300:0;return o().createElement(S.CSSTransition,{in:r,timeout:c,classNames:{enter:E.enter,enterActive:E.enterActive,enterDone:E.enterDone,exit:E.exit,exitActive:E.exitActive,exitDone:E.exitDone}},o().createElement("div",{className:l()(E.wrapper,E[i],{[E.isOpen]:r},s),"data-e2e":"menu-items",ref:a,style:h},o().createElement(_.s8,{atAndAbove:!0,size:y.SIZES.S},o().createElement(g.QW,{"data-e2e":"close-button",className:E.closeButton,onClick:n},o().createElement(f.bm,{alt:"close menu"}))),t))};T.propTypes={children:a().any,className:a().string,handleClose:a().func,isOpen:a().bool,nodeRef:a().shape({current:"undefined"!=typeof Element?a().instanceOf(Element):a().any}),position:a().oneOf(Object.values(I)),transition:a().bool.isRequired,style:a().object},T.defaultProps={className:null,handleClose:m.noop,isOpen:!1,nodeRef:null,position:I.BOTTOM,style:null};var C="DropdownMenu-module_wrapper__-3wi4",A="DropdownMenu-module_overlay__dGj87",R=!0;class M extends o().Component{constructor(e){var t;super(e),t=this,(0,n.A)(this,"handleResize",(()=>{this.closeMenu()})),(0,n.A)(this,"handleKeydown",(e=>{if(e.stopPropagation(),e.keyCode===m.keyMappings.esc)return this.closeMenu(null,R);(0,m.trapFocusInChildren)({event:e,children:(0,m.getFocusableChildren)(this.menuRef.current),exitFunction:this.closeMenu,tabCycle:!1})})),(0,n.A)(this,"addFocusTrap",(()=>{this.state.isOpen&&this.setFocus(this.menuRef.current)})),(0,n.A)(this,"setFocus",(e=>{(0,m.getFocusableChildren)(e)[0].focus()})),(0,n.A)(this,"toggleVisible",(()=>{this.state.isOpen?this.closeMenu(null,R):this.openMenu()})),(0,n.A)(this,"openMenu",(()=>{if(!this.state.isOpen){this.props.renderItemsInPortal&&window.innerWidth>y.BREAKPOINTS.DS2.s&&this.updateMenuItemsPosition();this.setState({isOpen:!0},(()=>{this.addFocusTrap(),this.props.onOpen()}))}})),(0,n.A)(this,"closeMenu",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e&&e.stopPropagation(),t.state.isOpen){var{delayClose:n,onClose:r}=t.props;s||n<1?t.setState({isOpen:!1},r):t.closeTimeout=setTimeout((()=>{t.setState({isOpen:!1},r)}),n)}})),(0,n.A)(this,"onHandleClick",(e=>{e.preventDefault(),this.toggleVisible()})),(0,n.A)(this,"onMouseEnter",(()=>{clearTimeout(this.closeTimeout),this.props.openOnHover&&this.openMenu()})),(0,n.A)(this,"onMouseLeave",(()=>{this.closeMenu()})),(0,n.A)(this,"updateMenuItemsPosition",(()=>{var e,t=null===(e=this.props.handleNodeRef)||void 0===e?void 0:e.current;if(t){var s=t.getBoundingClientRect(),n=window.scrollY||document.documentElement.scrollTop,r=window.scrollX||document.documentElement.scrollLeft;this.setState({handlePosition:{top:s.bottom+n+7,left:s.left+r}})}})),(0,n.A)(this,"renderMenuItems",(e=>o().createElement(T,{isOpen:this.state.isOpen,nodeRef:this.menuRef,handleClose:this.closeMenu,position:this.props.forcePosition,className:this.props.menuItemsClassName,transition:this.props.menuItemsTransition,style:e},this.props.children))),(0,n.A)(this,"renderMenuItemsForOverflowMenu",(e=>this.state.isOpen&&o().createElement(o().Fragment,null,o().createElement("div",{className:A,onClick:this.closeMenu}),this.renderMenuItems(e)))),this.state={isOpen:e.isOpen,handlePosition:null},this.wrapperRef=o().createRef(),this.menuRef=o().createRef(),this.handleKeydown=(0,h.throttle)(this.handleKeydown,200),this.handleResize=(0,h.throttle)(this.handleResize,200)}componentDidMount(){window.addEventListener("resize",this.handleResize)}componentWillUnmount(){window.removeEventListener("resize",this.handleResize)}render(){var e,t,s=this.state.isOpen&&(0,c.createPortal)(this.renderMenuItemsForOverflowMenu({top:null===(e=this.state.handlePosition)||void 0===e?void 0:e.top,left:null===(t=this.state.handlePosition)||void 0===t?void 0:t.left}),document.body);return o().createElement(d.tH,null,o().createElement("div",{className:l()(C),"data-e2e":this.props["data-e2e"],ref:this.wrapperRef,onKeyDown:this.handleKeydown,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},o().createElement(b,{buttonStyle:this.props.buttonStyle,className:this.props.menuHandleClassName,menuIsOpen:this.state.isOpen,onClick:this.onHandleClick,disabled:this.props.disabled,nodeRef:this.props.handleNodeRef,useTextHandle:this.props.useTextHandle},this.props.handle),this.props.renderItemsInPortal?s:this.renderMenuItems()))}}M.propTypes={buttonStyle:a().string,"data-e2e":a().string,children:a().any,delayClose:a().number,disabled:a().bool,forcePosition:a().oneOf(Object.values(I)),handle:a().any,handleNodeRef:a().oneOfType([a().func,a().shape({current:a().any})]),isOpen:a().bool,menuHandleClassName:a().string,menuItemsClassName:a().string,menuItemsTransition:a().bool,onClose:a().func,onOpen:a().func,openOnHover:a().bool,useTextHandle:a().bool,renderItemsInPortal:a().bool},M.defaultProps={buttonStyle:g.mj.DEFAULT,"data-e2e":null,delayClose:250,disabled:!1,isOpen:!1,menuHandleClassName:null,menuItemsClassName:null,menuItemsTransition:!1,onClose:m.noop,onOpen:m.noop,openOnHover:!1,useTextHandle:!0,renderItemsInPortal:!1};var q="PillSelectDropdown-module_menuItems__wA2Ti",w="PillSelectDropdown-module_list__UnuBG",k="PillSelectDropdown-module_option__p4OGe",O="PillSelectDropdown-module_optionSelected__PXQEf";function N(e){var{inputType:t,initialOption:s,itemPosition:n,onChange:r,options:a}=e,[u,h]=(0,i.useState)(s),c=e=>{r(e),h(e)},d=a.map((e=>{var s=u.value===e.value,n=()=>c(e),r={className:l()(k,{[O]:s}),key:e.value};return t?o().createElement("li",r,o().createElement(t,{onChange:n,labelText:e.label,selected:s},e.label)):o().createElement("li",(0,v.A)({},r,{onClick:n,onKeyDown:t=>((e,t)=>{e.which===m.keyMappings.enter&&c(t)})(t,e),tabIndex:0}),e.label)}));return o().createElement(M,{forcePosition:n,menuItemsClassName:q,menuItemsTransition:!0,handle:o().createElement(_.gK,{label:u.label})},o().createElement("ul",{className:w},d))}var x=a().shape({label:a().string,value:a().string});N.propTypes={initialOption:x.isRequired,inputType:a().elementType,itemPosition:a().oneOf(Object.values(I)),onChange:a().func,options:a().arrayOf(x).isRequired},N.defaultProps={inputType:null,onChange:m.noop}},74221:(e,t,s)=>{s.d(t,{A:()=>U,s:()=>V});var n=s(69740),r=s(98158),a=s(39067),i=s.n(a),o=s(32720),u=s.n(o),l=s(22355),h=s.n(l),c=s(11373),d=s(55425),g=s(72481),m=s(49634),p=s(11865),_=s(78082),S=s(96943),y=s(89575),f=s(63755),v="Suggestions-module_wrapper__eQtei",b="Suggestions-module_suggestionLabel__5VdWj",I="Suggestions-module_ulStyle__gwIbS",E="Suggestions-module_scribdList__qmQEs",T="Suggestions-module_suggestion__jG35z",C="Suggestions-module_selected__rq9nK",A="Suggestions-module_scribdSelected__trs9p",R="Suggestions-module_suggestions__HrK3q";class M extends u().Component{constructor(e){super(e),(0,r.A)(this,"handleTrackAndClick",(e=>{var{handleClick:t}=this.props;this.trackClick(e),t(e,!0)})),(0,r.A)(this,"handleMouseUp",(e=>{this.suggestionsRef.current&&!this.suggestionsRef.current.contains(e.target)&&this.trackCancel()})),(0,r.A)(this,"trackClick",(e=>{var{items:t,source:s,query:n}=this.props;(0,p.trackEvent)("search:drop_down_suggest:click",{page:window.location.pathname,search_session_id:(0,p.getSearchSessionId)(),source:s,query:e.query,query_typed:n,suggestions:t})})),(0,r.A)(this,"trackCancel",(()=>{var{items:e,source:t,query:s}=this.props;e.length&&(0,p.trackEvent)("search:drop_down_suggest:cancel",{page:window.location.pathname,search_session_id:(0,p.getSearchSessionId)(),source:t,query_typed:s,suggestions:e})})),this.suggestionsRef=u().createRef()}componentDidMount(){document.addEventListener("mouseup",this.handleMouseUp)}componentWillUnmount(){document.removeEventListener("mouseup",this.handleMouseUp)}rawHtml(e){return{__html:e.html?e.html:e.query}}renderSuggestionLabel(){var{labelText:e}=this.props;if(e)return u().createElement("div",{className:b},e)}renderLink(e){var{trust:t}=this.props;return t?u().createElement("a",{href:"#",onClick:e=>e.preventDefault(),dangerouslySetInnerHTML:this.rawHtml(e)}):u().createElement("a",{href:"#",onClick:e=>e.preventDefault()},e.query)}renderItems(){var{items:e,brand:t,selectedIndex:s}=this.props;return e.map(((e,n)=>{var r=h()(T,{[C]:s===n,[A]:t===d.BRANDS.SCRIBD}),a=h()({selected_suggestion:s===n});return u().createElement("li",{className:r,id:a,key:n.toString(),onClick:()=>this.handleTrackAndClick(e)},this.renderLink(e))}))}render(){var{listId:e,searchSuggestionsWrapperClassName:t,brand:s}=this.props;return u().createElement("div",{className:h()(v,t)},u().createElement("div",{className:R,id:e,ref:this.suggestionsRef,"data-e2e":"megamenu-top-bar-suggestions-list"},this.renderSuggestionLabel(),u().createElement("ul",{className:h()(I,{[E]:s===d.BRANDS.SCRIBD})},this.renderItems())))}}M.propTypes={handleClick:i().func.isRequired,items:i().arrayOf(i().shape({query:i().string.isRequired,html:i().string.isRequired,suggestion_id:i().oneOfType([i().number,i().string,i().oneOf([null])])})).isRequired,labelText:i().string,listId:i().string.isRequired,query:i().string.isRequired,searchSuggestionsWrapperClassName:i().string,brand:i().string,selectedIndex:i().number.isRequired,source:i().string.isRequired,trust:i().bool.isRequired},M.defaultProps={labelText:null,searchSuggestionsWrapperClassName:"",brand:null};class q{constructor(){(0,r.A)(this,"MAX_SEARCH_TERMS",10)}get_search_key(e){return"ugc"===e?"search_data_ugc":"search_data"}validateStorageData(e){var t=q.DEFAULT_DATA;if(!e)return t;var s,n={terms:(e=>{var t=[];return e&&Array.isArray(e)?t=e.slice(0,this.MAX_SEARCH_TERMS).reduce(((e,t)=>{var s={query:"",html:t.html||"",suggestion_id:t.suggestion_id||null};return s.query="string"==typeof t?t:t.query&&"string"==typeof t.query?t.query:"",s.query&&e.push(s),e}),[]):t})(null==e?void 0:e.terms),queryPreferences:(s=null==e?void 0:e.queryPreferences,s&&"object"==typeof s?s:{})};return Object.assign({},t,n)}read(e){var t=q.DEFAULT_DATA;return"undefined"==typeof window?t:(0,S.Z)((s=>{var n,r=s.getItem(this.get_search_key(e));try{n=JSON.parse(r)}catch(e){return console.error("Invalid JSON in localStorage:",e),t}return this.validateStorageData(n)}))}currentUniqueTerms(e){var t=this.read(e).terms,s=new Set,n=[];for(var r of t)r.query&&!s.has(r.query)&&(s.add(r.query),n.push(r));return n}clone(e){return e.slice(0)}moveExistingTermToMostRecent(e,t){var s=this.clone(t),[n]=s.splice(e,1);return s.unshift(n),s}saveTerms(e,t){return(0,S.Z)((s=>{var n=Object.assign({},this.read(t),{terms:e}),r=this.get_search_key(t);return s.setItem(r,JSON.stringify(n))}))}insertNewTerm(e,t){var s=this.clone(t);return s.length>=this.MAX_SEARCH_TERMS&&(s=s.slice(0,this.MAX_SEARCH_TERMS-1)),s.unshift(e),s}saveHistory(e,t){var s,n;if("undefined"!=typeof window){var r=this.currentUniqueTerms(t),a=r.findIndex((t=>t.query===e.query));return a>-1?r=this.moveExistingTermToMostRecent(a,r):0===(null===(s=r[0])||void 0===s||null===(n=s.query)||void 0===n?void 0:n.indexOf(e.query))?r[0]=e:r=this.insertNewTerm(e,r),this.saveTerms(r,t)}}}(0,r.A)(q,"DEFAULT_DATA",{terms:[],queryPreferences:{}});var w="control",k={label:"",html:"",suggestion_id:null},O="SearchForm-module_wrapper__lGGvF",N="SearchForm-module_clearButton__ggRgX",x="SearchForm-module_clearButtonScribd__XJbMU",D="SearchForm-module_searchInput__l73oF",F="SearchForm-module_searchInputScribd__Up4Ft",P="SearchForm-module_searchButton__4f-rn",B="SearchForm-module_closeRelatedSearchButton__c9LSI",L="SearchForm-module_focused__frjzW",H="SearchForm-module_inputWrapper__6iIKb";class U extends u().Component{constructor(e){var t;super(e),t=this,(0,r.A)(this,"onPopState",(e=>{e.preventDefault(),this.setState({backForwardClicked:!0})})),(0,r.A)(this,"handleLegacyHeaderInputFocus",(()=>{this.state.focused||this.searchInputRef.current.focus()})),(0,r.A)(this,"trackSuggestionsCancel",(()=>{this.state.suggestionItems.length&&(0,p.trackEvent)("search:drop_down_suggest:cancel",{source:this.source,search_session_id:(0,p.getSearchSessionId)(),page:window.location.pathname,query_typed:this.inputValue,suggestions:this.state.suggestionItems})})),(0,r.A)(this,"setHistory",(e=>{e.query&&(this.storage.saveHistory(e,this.props.brand),this.setState({queryHistory:this.getHistory()}))})),(0,r.A)(this,"handleGotQuerySuggestions",(function(e,s){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];s&&(r=t.memoizedQueries[e]=s.map((e=>({query:e.suggestion,html:e.suggestion_html||e.suggestion,suggestion_id:e.suggestion_id||null})))),t.setState({suggestionItems:r,trustSuggestionItems:n,suggestionsXhr:null})})),(0,r.A)(this,"submitSearch",((e,t)=>{this.searchSubmitted=!0,this.setHistory(e);var s=t||this.state.suggestionIndex>=0,n=this.getSearchParams(e,s);this.setState({queryTyped:e.query},(()=>{this.closeSuggestions(),this.navigateToApp(n)}))})),(0,r.A)(this,"closeSuggestions",(()=>{var{handleSearchFocus:e}=this.props;this.searchSubmitted||this.trackSuggestionsCancel(),this.setState({focused:!1,suggestedItem:k,suggestionIndex:-1,suggestionItems:[]},(()=>e(!1)))})),(0,r.A)(this,"handleCloseSuggestionsClick",(e=>{e.preventDefault(),this.closeSuggestions()})),(0,r.A)(this,"handleClick",(()=>{(0,p.trackEvent)("search:box:click",{page:this.page,search_session_id:(0,p.getSearchSessionId)()})})),(0,r.A)(this,"handleSearchButtonClick",(e=>{this.handleSubmit(e),this.closeSuggestions()})),(0,r.A)(this,"handleClearButtonClick",(()=>{this.getSuggestions("")})),(0,r.A)(this,"handleSubmit",(e=>{if(e.preventDefault(),this.state.suggestedItem.query||this.state.queryTyped){-1!==this.state.suggestionIndex&&(0,p.trackEvent)("search:drop_down_suggest:submit",{page:this.page,search_session_id:(0,p.getSearchSessionId)(),source:this.source,query:this.state.suggestedItem.query});var t=this.state.suggestedItem.query?this.state.suggestedItem:{query:this.inputValue,suggestion_id:null};this.submitSearch(t,!1)}})),(0,r.A)(this,"handleBlur",(()=>{setTimeout(this.closeSuggestions,300)})),(0,r.A)(this,"handleChange",(e=>{e.persist(),this.setState({queryTyped:e.target.value,suggestionIndex:-1},(()=>{this.getSuggestions(e.target.value)}))})),(0,r.A)(this,"handleKeydown",(e=>{var{enter:t,up_arrow:s,down_arrow:n,esc:r,tab:a}=p.keyMappings;switch(e.keyCode){case t:this.handleSubmit(e),e.target.blur(),this.closeSuggestions();break;case s:e.preventDefault(),this.navigateSuggestions(-1);break;case n:e.preventDefault(),this.navigateSuggestions(1);break;case r:e.preventDefault(),e.target.blur(),this.closeSuggestions();break;case a:this.state.suggestionItems.length>0&&(this.closeSuggestions(),e.currentTarget.focus());break;default:return void(this.state.focused||this.setState({focused:!0}))}})),(0,r.A)(this,"handleHideSuggestions",(e=>{this.searchFormRef&&!this.searchFormRef.current.contains(e.target)&&this.hideSuggestions()})),(0,r.A)(this,"handleFocus",(()=>{var{handleSearchFocus:e,onSearchFocus:t}=this.props;this.setState({focused:!0},(()=>{this.getSuggestions(this.state.queryTyped)})),e(!0),this.trackRenderedSearchItems(),t()})),this.searchFormRef=u().createRef(),this.searchInputRef=u().createRef(),this.state={brand:e.brand,userId:e.userId,focused:!1,queryHistory:[],queryTyped:e.queryTyped,suggestedItem:k,suggestionIndex:-1,suggestionsXhr:null,suggestionItems:[],trustSuggestionItems:!0,backForwardClicked:!1},this.memoizedQueries={}}componentDidMount(){document.addEventListener("click",this.handleHideSuggestions),window.addEventListener("header:search_page:focus_input",this.handleLegacyHeaderInputFocus),window.addEventListener("popstate",this.onPopState),this.setState({queryHistory:this.getHistory()})}componentWillUnmount(){window.removeEventListener("header:search_page:focus_input",this.handleLegacyHeaderInputFocus),document.removeEventListener("click",this.handleHideSuggestions),window.removeEventListener("popstate",this.onPopState)}getHistory(){var e=this.storage.read(this.props.brand);if(e)return e.terms}trackRenderedSearchItems(){var e=this.inputValue,t=(0,p.getSearchSessionId)(),s=this.page,n=e?"query_suggestions":"search_history";(0,p.trackEvent)("search:drop_down_suggest:show",{layout:n,query:e,search_session_id:t,page:s})}get storage(){return this._storage||(this._storage=new q)}get source(){return this.state.queryTyped?"query_suggester":"recent_search"}get page(){return window.location.pathname.split("/")[1]||"home"}get inputValue(){return this.state.suggestionIndex>-1?this.state.suggestedItem.query:this.state.queryTyped}get placeholderText(){return this.props.placeholderText||c.default.t("megamenu.search_bar.search")}get labelText(){return 0===this.state.queryTyped.length?c.default.t("megamenu.search_bar.recent_searches"):""}getSuggestedItem(e){return e<0?k:this.state.suggestionItems[e]}getSuggestions(e){if(this.state.suggestionsXhr&&this.state.suggestionsXhr.abort(),e)if(this.memoizedQueries[e])this.setState({queryTyped:e,suggestionItems:this.memoizedQueries[e],trustSuggestionItems:!0});else{var t=function(e,t,s,n,r){var a="/query_suggestions/web?query=".concat(e);return t!==d.BRANDS.EVERAND&&t!==d.BRANDS.SCRIBD||(a+="&brand=".concat(t)),null!=s&&(a+="&user_id=".concat(s)),null!=n&&(a+="&variant=".concat(n)),p.xhr.get({url:a},((t,s,n)=>{if(!t){var a=JSON.parse(n),i=!!a.query_suggestions;r(e,a.query_suggestions||[],i)}}))}(e,this.state.brand,this.state.userId,this.props.suggestionsVariant,this.handleGotQuerySuggestions);this.setState({queryTyped:e,suggestionsXhr:t})}else this.useQueryHistory()}useQueryHistory(){this.setState({queryTyped:"",suggestionItems:Array.from(this.state.queryHistory),trustSuggestionItems:!1})}navigateToApp(e){var{searchPath:t,searchFunction:s}=this.props;"undefined"!=typeof window&&s("".concat(t,"?").concat(this.getParams(e)))}getParams(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object.keys(e).map((s=>"".concat(s,"=").concat(t?encodeURIComponent(e[s]):e[s]))).join("&")}navigateSuggestions(e){var t=Math.min(this.state.suggestionItems.length-1,Math.max(this.state.suggestionIndex+e,-1));this.setState({suggestedItem:this.getSuggestedItem(t),suggestionIndex:t})}getSearchParams(e,t){var s=this.storage.read(this.props.brand),r=s?s.queryPreferences:{},{query:a,suggestion_id:i}=e,o=(0,n.A)((0,n.A)({query:a},null!==i&&{suggestion_id:i}),r[e.query]),u=new URLSearchParams(window.location.search).get("language");return u&&(o.language=u),t&&(o.verbatim=!0),o}hideSuggestions(){var{handleSearchFocus:e}=this.props;this.setState({focused:!1,suggestionIndex:-1,suggestionItems:[]}),e(!1)}shouldShowSuggestions(){var{focused:e}=this.state,{keepSuggestionsOnBlur:t}=this.props,s=this.state.suggestionItems.length>0;return(e||t)&&s}renderVisuallyHiddenResultsCount(){var e;if(this.state.focused)return e=this.shouldShowSuggestions()?c.default.t("megamenu.search_bar.num_results_are_available",{num_results:this.state.suggestionItems.length}):c.default.t("megamenu.search_bar.no_results_found"),u().createElement(g.s,{"aria-atomic":"true",role:"status","aria-live":"polite",id:"aria_live_status_container"},e)}renderSuggestions(){if(this.shouldShowSuggestions())return u().createElement(M,{handleClick:this.submitSearch,items:this.state.suggestionItems,labelText:this.labelText,listId:"suggestions_list",page:this.page,query:this.state.queryTyped,brand:this.props.brand,searchSuggestionsWrapperClassName:this.props.searchSuggestionsWrapperClassName,selectedIndex:this.state.suggestionIndex,source:this.source,trust:this.state.trustSuggestionItems})}render(){var{brand:e,extraClasses:t,SearchButtonComponent:s,searchInputClassName:n,shouldStyleFocusedState:r}=this.props,{focused:a}=this.state;return this.state.backForwardClicked&&this.props.queryTyped!==this.state.queryTyped&&this.setState({queryTyped:this.props.queryTyped,backForwardClicked:!1}),u().createElement("div",{className:h()(O,"search_input_container",t,{[L]:a&&r}),role:"search"},u().createElement("form",{className:"search_form",onSubmit:this.handleSubmit,ref:this.searchFormRef},u().createElement("div",{className:h()(H)},u().createElement("button",{type:"button",onClick:this.handleCloseSuggestionsClick,className:B},u().createElement(_.B$J,{alt:c.default.t("megamenu.search_bar.close_suggestions"),className:"icon"})),u().createElement("label",null,u().createElement(g.s,null,c.default.t("megamenu.search_bar.search")),u().createElement("input",{autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",className:h()(D,n,{[F]:e===d.BRANDS.SCRIBD}),"data-e2e":"megamenu-top-bar-search-input",id:"header_search_input",name:"query",onBlur:this.handleBlur,onChange:this.handleChange,onClick:this.handleClick,onFocus:this.handleFocus,onKeyDown:this.handleKeydown,placeholder:this.state.focused?"":this.placeholderText,ref:this.searchInputRef,type:"search",value:this.inputValue})),s?u().createElement(s,{onClick:this.handleSearchButtonClick}):u().createElement(u().Fragment,null,""!==this.inputValue&&u().createElement(m.QW,{className:h()(N,{[x]:e===d.BRANDS.SCRIBD}),"data-e2e":"megamenu-top-bar-clear_button",onClick:this.handleClearButtonClick,type:"submit"},u().createElement(_.sn9,{className:"icon"}),u().createElement(g.s,null," ",c.default.t("megamenu.search_bar.clear_search"))),u().createElement(m.QW,{className:h()(P,"no_spinner"),"data-e2e":"megamenu-top-bar-search-button",onClick:this.handleSearchButtonClick,type:"submit"},u().createElement(_.XAP,{className:"icon"}),u().createElement(g.s,null,c.default.t("megamenu.search_bar.search"))))),this.renderVisuallyHiddenResultsCount(),this.renderSuggestions()))}}U.propTypes={brand:i().string,extraClasses:i().string,handleSearchFocus:i().func,keepSuggestionsOnBlur:i().bool,onSearchFocus:i().func,placeholderText:i().string,queryTyped:i().string,SearchButtonComponent:i().node,searchFunction:i().func,searchInputClassName:i().string,searchPath:i().string.isRequired,searchSuggestionsWrapperClassName:i().string,shouldStyleFocusedState:i().bool,suggestionsVariant:i().string,userId:i().number},U.defaultProps={brand:null,extraClasses:"",searchInputClassName:"",searchSuggestionsWrapperClassName:"",handleSearchFocus:p.noop,keepSuggestionsOnBlur:!1,onSearchFocus:p.noop,SearchButtonComponent:null,shouldStyleFocusedState:!0,placeholderText:null,queryTyped:"",searchFunction:p.redirect,suggestionsVariant:w,userId:null};var V=e=>{var{Statsig:t,isStatsigInitialized:s}=(0,f.A)(),[n,r]=(0,o.useState)(w);return(0,o.useEffect)((()=>{if(s){var e=t.getExperiment("smart_suggestions"),n=e?e.get("variant"):w;r(n)}}),[s]),u().createElement(U,(0,y.A)({},e,{suggestionsVariant:n}))}}}]);
//# sourceMappingURL=https://www.scribd.com/webpack/monolith/7438.5f753ccf7bb2c3eba82e.js.map