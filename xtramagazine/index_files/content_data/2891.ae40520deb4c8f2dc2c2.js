"use strict";(self.webpackChunk_scribd_app_monolith=self.webpackChunk_scribd_app_monolith||[]).push([[2891],{66911:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._resolveDeltasResponse=void 0;const i=s(253);function r(e,t){null==e||e.forEach((e=>{delete t[e]}))}t._resolveDeltasResponse=function(e,t){const s=(0,i._typedJsonParse)(t,"checksum","DeltasEvaluationResponse");if(!s)return{hadBadDeltaChecksum:!0};const a=function(e){const t=e;return r(e.deleted_gates,t.feature_gates),delete t.deleted_gates,r(e.deleted_configs,t.dynamic_configs),delete t.deleted_configs,r(e.deleted_layers,t.layer_configs),delete t.deleted_layers,t}(function(e,t){return Object.assign(Object.assign(Object.assign({},e),t),{feature_gates:Object.assign(Object.assign({},e.feature_gates),t.feature_gates),layer_configs:Object.assign(Object.assign({},e.layer_configs),t.layer_configs),dynamic_configs:Object.assign(Object.assign({},e.dynamic_configs),t.dynamic_configs)})}(e,s)),n=(0,i._DJB2Object)({feature_gates:a.feature_gates,dynamic_configs:a.dynamic_configs,layer_configs:a.layer_configs},2);return n===s.checksumV2?JSON.stringify(a):{hadBadDeltaChecksum:!0,badChecksum:n,badMergedConfigs:a,badFullResponse:s.deltas_full_response}}},1654:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=s(253);t.default=class{constructor(e){this._sdkKey=e,this._rawValues=null,this._values=null,this._source="Uninitialized",this._lcut=0,this._receivedAt=0,this._bootstrapMetadata=null,this._warnings=new Set}reset(){this._values=null,this._rawValues=null,this._source="Loading",this._lcut=0,this._receivedAt=0,this._bootstrapMetadata=null}finalize(){this._values||(this._source="NoValues")}getValues(){return this._rawValues?(0,i._typedJsonParse)(this._rawValues,"has_updates","EvaluationStoreValues"):null}setValues(e,t){if(!e)return!1;const s=(0,i._typedJsonParse)(e.data,"has_updates","EvaluationResponse");return null!=s&&(this._source=e.source,!0!==(null==s?void 0:s.has_updates)||(this._rawValues=e.data,this._lcut=s.time,this._receivedAt=e.receivedAt,this._values=s,this._bootstrapMetadata=this._extractBootstrapMetadata(e.source,s),e.source&&s.user&&this._setWarningState(t,s)),!0)}getGate(e){var t;return this._getDetailedStoreResult(null===(t=this._values)||void 0===t?void 0:t.feature_gates,e)}getConfig(e){var t;return this._getDetailedStoreResult(null===(t=this._values)||void 0===t?void 0:t.dynamic_configs,e)}getLayer(e){var t;return this._getDetailedStoreResult(null===(t=this._values)||void 0===t?void 0:t.layer_configs,e)}getParamStore(e){var t;return this._getDetailedStoreResult(null===(t=this._values)||void 0===t?void 0:t.param_stores,e)}_extractBootstrapMetadata(e,t){if("Bootstrap"!==e)return null;const s={};return t.user&&(s.user=t.user),t.sdkInfo&&(s.generatorSDKInfo=t.sdkInfo),s.lcut=t.time,s}_getDetailedStoreResult(e,t){let s=null;return e&&(s=e[t]?e[t]:e[(0,i._DJB2)(t)]),{result:s,details:this._getDetails(null==s)}}_setWarningState(e,t){var s;const r=i.StableID.get(this._sdkKey);if((null===(s=e.customIDs)||void 0===s?void 0:s.stableID)===r){if("user"in t){const s=t.user;(0,i._getFullUserHash)(e)!==(0,i._getFullUserHash)(s)&&this._warnings.add("PartialUserMatch")}}else this._warnings.add("StableIDMismatch")}getCurrentSourceDetails(){if("Uninitialized"===this._source||"NoValues"===this._source)return{reason:this._source};const e={reason:this._source,lcut:this._lcut,receivedAt:this._receivedAt};return this._warnings.size>0&&(e.warnings=Array.from(this._warnings)),e}_getDetails(e){var t,s;const i=this.getCurrentSourceDetails();let r=i.reason;const a=null!==(t=i.warnings)&&void 0!==t?t:[];if("Bootstrap"===this._source&&a.length>0&&(r+=a[0]),"Uninitialized"!==r&&"NoValues"!==r){r=`${r}:${e?"Unrecognized":"Recognized"}`}const n="Bootstrap"===this._source&&null!==(s=this._bootstrapMetadata)&&void 0!==s?s:void 0;return n&&(i.bootstrapMetadata=n),Object.assign(Object.assign({},i),{reason:r})}}},2635:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,a){function n(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=s(253),a=s(66911);class n extends r.NetworkCore{constructor(e,t){super(e,t);const s=null==e?void 0:e.networkConfig;this._initializeUrlConfig=new r.UrlConfiguration(r.Endpoint._initialize,null==s?void 0:s.initializeUrl,null==s?void 0:s.api,null==s?void 0:s.initializeFallbackUrls)}fetchEvaluations(e,t,s,a){return i(this,void 0,void 0,(function*(){const i=t?(0,r._typedJsonParse)(t,"has_updates","InitializeResponse"):null;let n={user:a,hash:"djb2",deltasResponseRequested:!1};return(null==i?void 0:i.has_updates)&&(n=Object.assign(Object.assign({},n),{sinceTime:i.time,previousDerivedFields:"derived_fields"in i?i.derived_fields:{},deltasResponseRequested:!0})),this._fetchEvaluations(e,i,n,s)}))}_fetchEvaluations(e,t,s,r){var n,o;return i(this,void 0,void 0,(function*(){const i=yield this.post({sdkKey:e,urlConfig:this._initializeUrlConfig,data:s,retries:2,isStatsigEncodable:!0,priority:r});if(204===(null==i?void 0:i.code))return'{"has_updates": false}';if(200!==(null==i?void 0:i.code))return null!==(n=null==i?void 0:i.body)&&void 0!==n?n:null;if(!0!==(null==t?void 0:t.has_updates)||!0!==(null===(o=i.body)||void 0===o?void 0:o.includes('"is_delta":true'))||!0!==s.deltasResponseRequested)return i.body;const l=(0,a._resolveDeltasResponse)(t,i.body);return"string"==typeof l?l:this._fetchEvaluations(e,t,Object.assign(Object.assign(Object.assign({},s),l),{deltasResponseRequested:!1}),r)}))}}t.default=n},89464:(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._makeParamStoreGetter=void 0;const i=s(253),r={disableExposureLog:!0};function a(e){return null==e||!1===e.disableExposureLog}function n(e,t){return null!=t&&!(0,i._isTypeMatch)(e,t)}t._makeParamStoreGetter=function(e,t,s){return(o,l)=>{if(null==t)return l;const u=t[o];if(null==u||null!=l&&(0,i._typeOf)(l)!==u.param_type)return l;switch(u.ref_type){case"static":return function(e){return e.value}(u);case"gate":return function(e,t,s){return e.getFeatureGate(t.gate_name,a(s)?void 0:r).value?t.pass_value:t.fail_value}(e,u,s);case"dynamic_config":return function(e,t,s,i){const o=e.getDynamicConfig(t.config_name,r).get(t.param_name);return n(o,s)?s:(a(i)&&e.getDynamicConfig(t.config_name),o)}(e,u,l,s);case"experiment":return function(e,t,s,i){const o=e.getExperiment(t.experiment_name,r).get(t.param_name);return n(o,s)?s:(a(i)&&e.getExperiment(t.experiment_name),o)}(e,u,l,s);case"layer":return function(e,t,s,i){const o=e.getLayer(t.layer_name,r).get(t.param_name);return n(o,s)?s:(a(i)&&e.getLayer(t.layer_name).get(t.param_name),o)}(e,u,l,s);default:return l}}}},20749:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,a){function n(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=s(253),a=s(1654),n=s(2635),o=s(89464),l=s(57276);class u extends r.StatsigClientBase{static instance(e){const t=(0,r._getStatsigGlobal)().instance(e);return t instanceof u?t:(r.Log.warn((0,r._isServerEnv)()?"StatsigClient.instance is not supported in server environments":"Unable to find StatsigClient instance"),new u(null!=e?e:"",{}))}constructor(e,t,s=null){var i,o;r.SDKType._setClientType(e,"javascript-client");const u=new n.default(s,(e=>{this.$emt(e)}));super(e,null!==(i=null==s?void 0:s.dataAdapter)&&void 0!==i?i:new l.StatsigEvaluationsDataAdapter,u,s),this._store=new a.default(e),this._user=(0,r._normalizeUser)(t,s);const d=null!==(o=null==s?void 0:s.plugins)&&void 0!==o?o:[];for(const e of d)e.bind(this)}initializeSync(e){"Uninitialized"===this.loadingStatus&&(this._logger.start(),this.updateUserSync(this._user,e))}initializeAsync(e){return i(this,void 0,void 0,(function*(){return this._initializePromise||(this._initializePromise=this._initializeAsyncImpl(e)),this._initializePromise}))}updateUserSync(e,t){this._resetForUser(e);const s=this.dataAdapter.getDataSync(this._user);this._store.setValues(s,this._user),this._finalizeUpdate(s);const i=null==t?void 0:t.disableBackgroundCacheRefresh;!0===i||null==i&&"Bootstrap"===(null==s?void 0:s.source)||this._runPostUpdate(null!=s?s:null,this._user)}updateUserAsync(e,t){return i(this,void 0,void 0,(function*(){this._resetForUser(e);const s=this._user;r.Diagnostics._markInitOverallStart(this._sdkKey);let i=this.dataAdapter.getDataSync(s);if(this._store.setValues(i,this._user),this._setStatus("Loading",i),i=yield this.dataAdapter.getDataAsync(i,s,t),s!==this._user)return;let a=!1;null!=i&&(r.Diagnostics._markInitProcessStart(this._sdkKey),a=this._store.setValues(i,this._user),r.Diagnostics._markInitProcessEnd(this._sdkKey,{success:a})),this._finalizeUpdate(i),a||this.$emt({name:"initialization_failure"}),r.Diagnostics._markInitOverallEnd(this._sdkKey,a,this._store.getCurrentSourceDetails()),r.Diagnostics._enqueueDiagnosticsEvent(this._user,this._logger,this._sdkKey,this._options)}))}getContext(){return{sdkKey:this._sdkKey,options:this._options,values:this._store.getValues(),user:JSON.parse(JSON.stringify(this._user)),errorBoundary:this._errorBoundary,session:r.StatsigSession.get(this._sdkKey),stableID:r.StableID.get(this._sdkKey)}}checkGate(e,t){return this.getFeatureGate(e,t).value}getFeatureGate(e,t){var s,i;const{result:a,details:n}=this._store.getGate(e),o=(0,r._makeFeatureGate)(e,n,a),l=null===(i=null===(s=this.overrideAdapter)||void 0===s?void 0:s.getGateOverride)||void 0===i?void 0:i.call(s,o,this._user,t),u=null!=l?l:o;return this._enqueueExposure(e,(0,r._createGateExposure)(this._user,u),t),this.$emt({name:"gate_evaluation",gate:u}),u}getDynamicConfig(e,t){var s,i;const{result:a,details:n}=this._store.getConfig(e),o=(0,r._makeDynamicConfig)(e,n,a),l=null===(i=null===(s=this.overrideAdapter)||void 0===s?void 0:s.getDynamicConfigOverride)||void 0===i?void 0:i.call(s,o,this._user,t),u=null!=l?l:o;return this._enqueueExposure(e,(0,r._createConfigExposure)(this._user,u),t),this.$emt({name:"dynamic_config_evaluation",dynamicConfig:u}),u}getExperiment(e,t){var s,i;const{result:a,details:n}=this._store.getConfig(e),o=(0,r._makeExperiment)(e,n,a),l=null===(i=null===(s=this.overrideAdapter)||void 0===s?void 0:s.getExperimentOverride)||void 0===i?void 0:i.call(s,o,this._user,t),u=null!=l?l:o;return this._enqueueExposure(e,(0,r._createConfigExposure)(this._user,u),t),this.$emt({name:"experiment_evaluation",experiment:u}),u}getLayer(e,t){var s,i,a;const{result:n,details:o}=this._store.getLayer(e),l=(0,r._makeLayer)(e,o,n),u=null===(i=null===(s=this.overrideAdapter)||void 0===s?void 0:s.getLayerOverride)||void 0===i?void 0:i.call(s,l,this._user,t),d=(0,r._mergeOverride)(l,u,null!==(a=null==u?void 0:u.__value)&&void 0!==a?a:l.__value,(s=>{this._enqueueExposure(e,(0,r._createLayerParameterExposure)(this._user,d,s),t)}));return this.$emt({name:"layer_evaluation",layer:d}),d}getParameterStore(e,t){const{result:s,details:i}=this._store.getParamStore(e);return this._logger.incrementNonExposureCount(e),{name:e,details:i,__configuration:s,get:(0,o._makeParamStoreGetter)(this,s,t)}}logEvent(e,t,s){const i="string"==typeof e?{eventName:e,value:t,metadata:s}:e;this._logger.enqueue(Object.assign(Object.assign({},i),{user:this._user,time:Date.now()}))}_primeReadyRipcord(){this.$on("error",(()=>{"Loading"===this.loadingStatus&&this._finalizeUpdate(null)}))}_initializeAsyncImpl(e){return i(this,void 0,void 0,(function*(){return r.Storage.isReady()||(yield r.Storage.isReadyResolver()),this._logger.start(),this.updateUserAsync(this._user,e)}))}_finalizeUpdate(e){this._store.finalize(),this._setStatus("Ready",e)}_runPostUpdate(e,t){this.dataAdapter.getDataAsync(e,t,{priority:"low"}).catch((e=>{r.Log.error("An error occurred after update.",e)}))}_resetForUser(e){var t;this._logger.reset(),this._store.reset(),this._user=(0,r._normalizeUser)(e,this._options);const s=null===(t=this._user.customIDs)||void 0===t?void 0:t.stableID;s&&r.StableID.setOverride(s,this._sdkKey)}}t.default=u},57276:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,a){function n(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StatsigEvaluationsDataAdapter=void 0;const r=s(253),a=s(2635);class n extends r.DataAdapterCore{constructor(){super("EvaluationsDataAdapter","evaluations"),this._network=null,this._options=null}attach(e,t){super.attach(e,t),this._network=new a.default(null!=t?t:{})}getDataAsync(e,t,s){return this._getDataAsyncImpl(e,(0,r._normalizeUser)(t,this._options),s)}prefetchData(e,t){return this._prefetchDataImpl(e,t)}setData(e){const t=(0,r._typedJsonParse)(e,"has_updates","data");t&&"user"in t?super.setData(e,t.user):r.Log.error("StatsigUser not found. You may be using an older server SDK version. Please upgrade your SDK or use setDataLegacy.")}setDataLegacy(e,t){super.setData(e,t)}_fetchFromNetwork(e,t,s){var r;return i(this,void 0,void 0,(function*(){const i=yield null===(r=this._network)||void 0===r?void 0:r.fetchEvaluations(this._getSdkKey(),e,null==s?void 0:s.priority,t);return null!=i?i:null}))}_getCacheKey(e){var t;const s=(0,r._getStorageKey)(this._getSdkKey(),e,null===(t=this._options)||void 0===t?void 0:t.customUserCacheKeyFunc);return`${r.DataAdapterCachePrefix}.${this._cacheSuffix}.${s}`}_isCachedResultValidFor204(e,t){return null!=e.fullUserHash&&e.fullUserHash===(0,r._getFullUserHash)(t)}}t.StatsigEvaluationsDataAdapter=n},25789:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var r=Object.getOwnPropertyDescriptor(t,s);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,r)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),r=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),t.StatsigClient=void 0;const a=s(20749);t.StatsigClient=a.default,r(s(253),t),__STATSIG__=Object.assign(Object.assign({},null!==__STATSIG__&&void 0!==__STATSIG__?__STATSIG__:{}),{StatsigClient:a.default}),t.default=__STATSIG__},47185:function(e,t,s){var i=this&&this.__awaiter||function(e,t,s,i){return new(s||(s=Promise))((function(r,a){function n(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.LocalOverrideAdapter=void 0;const r=s(253),a="LocalOverride:Recognized";t.LocalOverrideAdapter=class{constructor(e){this._overrides={gate:{},dynamicConfig:{},experiment:{},layer:{}},this._sdkKey=null!=e?e:null}_getLocalOverridesStorageKey(e){return`statsig.local-overrides.${(0,r._getStorageKey)(e)}`}loadFromStorage(){return i(this,void 0,void 0,(function*(){if(null==this._sdkKey)return;r.Storage.isReady()||(yield r.Storage.isReadyResolver());const e=this._getLocalOverridesStorageKey(this._sdkKey),t=r.Storage.getItem(e),s=t?(0,r._typedJsonParse)(t,"gate","LocalOverrideAdapter overrides"):null,i=this._hasInMemoryOverrides();var a,n;s&&(this._overrides=i?(a=s,n=this._overrides,{gate:Object.assign({},a.gate,n.gate),dynamicConfig:Object.assign({},a.dynamicConfig,n.dynamicConfig),experiment:Object.assign({},a.experiment,n.experiment),layer:Object.assign({},a.layer,n.layer)}):s),i&&this._saveOverridesToStorage()}))}_saveOverridesToStorage(){if(null==this._sdkKey||!r.Storage.isReady())return;const e=this._getLocalOverridesStorageKey(this._sdkKey);r.Storage.setItem(e,JSON.stringify(this._overrides))}overrideGate(e,t){this._overrides.gate[e]=t,this._overrides.gate[(0,r._DJB2)(e)]=t,this._saveOverridesToStorage()}_warnIfStorageNotReady(){r.Storage.isReady()||r.Log.warn("Storage is not ready. Override removal may not persist.")}removeGateOverride(e){this._warnIfStorageNotReady(),delete this._overrides.gate[e],delete this._overrides.gate[(0,r._DJB2)(e)],this._saveOverridesToStorage()}getGateOverride(e,t){var s;const i=null!==(s=this._overrides.gate[e.name])&&void 0!==s?s:this._overrides.gate[(0,r._DJB2)(e.name)];return null==i?null:Object.assign(Object.assign({},e),{value:i,details:Object.assign(Object.assign({},e.details),{reason:a})})}overrideDynamicConfig(e,t){this._overrides.dynamicConfig[e]=t,this._overrides.dynamicConfig[(0,r._DJB2)(e)]=t,this._saveOverridesToStorage()}removeDynamicConfigOverride(e){this._warnIfStorageNotReady(),delete this._overrides.dynamicConfig[e],delete this._overrides.dynamicConfig[(0,r._DJB2)(e)],this._saveOverridesToStorage()}getDynamicConfigOverride(e,t){return this._getConfigOverride(e,this._overrides.dynamicConfig)}overrideExperiment(e,t){this._overrides.experiment[e]=t,this._overrides.experiment[(0,r._DJB2)(e)]=t,this._saveOverridesToStorage()}removeExperimentOverride(e){this._warnIfStorageNotReady(),delete this._overrides.experiment[e],delete this._overrides.experiment[(0,r._DJB2)(e)],this._saveOverridesToStorage()}getExperimentOverride(e,t){return this._getConfigOverride(e,this._overrides.experiment)}overrideLayer(e,t){this._overrides.layer[e]=t,this._overrides.layer[(0,r._DJB2)(e)]=t,this._saveOverridesToStorage()}removeLayerOverride(e){this._warnIfStorageNotReady(),delete this._overrides.layer[e],delete this._overrides.layer[(0,r._DJB2)(e)],this._saveOverridesToStorage()}getAllOverrides(){return JSON.parse(JSON.stringify(this._overrides))}removeAllOverrides(){this._warnIfStorageNotReady(),this._overrides={gate:{},dynamicConfig:{},experiment:{},layer:{}},this._saveOverridesToStorage()}getLayerOverride(e,t){var s;const i=null!==(s=this._overrides.layer[e.name])&&void 0!==s?s:this._overrides.layer[(0,r._DJB2)(e.name)];return null==i?null:Object.assign(Object.assign({},e),{__value:i,get:(0,r._makeTypedGet)(e.name,i),details:Object.assign(Object.assign({},e.details),{reason:a})})}_getConfigOverride(e,t){var s;const i=null!==(s=t[e.name])&&void 0!==s?s:t[(0,r._DJB2)(e.name)];return null==i?null:Object.assign(Object.assign({},e),{value:i,get:(0,r._makeTypedGet)(e.name,i),details:Object.assign(Object.assign({},e.details),{reason:a})})}_hasInMemoryOverrides(){return Object.keys(this._overrides.gate).length>0||Object.keys(this._overrides.dynamicConfig).length>0||Object.keys(this._overrides.experiment).length>0||Object.keys(this._overrides.layer).length>0}}},92615:function(e,t,s){var i=this&&this.__createBinding||(Object.create?function(e,t,s,i){void 0===i&&(i=s);var r=Object.getOwnPropertyDescriptor(t,s);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[s]}}),Object.defineProperty(e,i,r)}:function(e,t,s,i){void 0===i&&(i=s),e[i]=t[s]}),r=this&&this.__exportStar||function(e,t){for(var s in e)"default"===s||Object.prototype.hasOwnProperty.call(t,s)||i(t,e,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(s(47185),t)}}]);
//# sourceMappingURL=https://www.scribd.com/webpack/monolith/2891.ae40520deb4c8f2dc2c2.js.map