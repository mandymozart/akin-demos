"use strict";(self.webpackChunk_scribd_app_monolith=self.webpackChunk_scribd_app_monolith||[]).push([[6248],{82256:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},49843:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Log=t.LogLevel=void 0;function n(e){return e.unshift("[Statsig]"),e}t.LogLevel={None:0,Error:1,Warn:2,Info:3,Debug:4};class o{static info(...e){o.level>=t.LogLevel.Info&&console.info("  INFO ",...n(e))}static debug(...e){o.level>=t.LogLevel.Debug&&console.debug(" DEBUG ",...n(e))}static warn(...e){o.level>=t.LogLevel.Warn&&console.warn("  WARN ",...n(e))}static error(...e){o.level>=t.LogLevel.Error&&console.error(" ERROR ",...n(e))}}t.Log=o,o.level=t.LogLevel.Warn},11880:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createMemoKey=t.MemoPrefix=void 0,t.MemoPrefix={_gate:"g",_dynamicConfig:"c",_experiment:"e",_layer:"l",_paramStore:"p"};const n=new Set([]),o=new Set(["userPersistedValues"]);t.createMemoKey=function(e,t,r){let i=`${e}|${t}`;if(!r)return i;for(const e of Object.keys(r)){if(o.has(e))return;n.has(e)?i+=`|${e}=true`:i+=`|${e}=${r[e]}`}return i}},5653:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkParam=t.NetworkDefault=t.Endpoint=void 0,t.Endpoint={_initialize:"initialize",_rgstr:"rgstr",_download_config_specs:"download_config_specs"},t.NetworkDefault={[t.Endpoint._rgstr]:"https://prodregistryv2.org/v1",[t.Endpoint._initialize]:"https://featureassets.org/v1",[t.Endpoint._download_config_specs]:"https://api.statsigcdn.com/v1"},t.NetworkParam={EventCount:"ec",SdkKey:"k",SdkType:"st",SdkVersion:"sv",Time:"t",SessionID:"sid",StatsigEncoded:"se",IsGzipped:"gz"}},95752:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function l(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkCore=void 0,n(47186);const r=n(47186),i=n(65801),s=n(49843),l=n(5653),a=n(88655),u=n(94082),d=n(39561),c=n(82487),f=n(7532),g=n(57195),v=n(80427),_=n(78131),p=n(25935),h=n(36038),y=new Set([408,500,502,503,504,522,524,599]);t.NetworkCore=class{constructor(e,t){this._emitter=t,this._errorBoundary=null,this._timeout=1e4,this._netConfig={},this._options={},this._leakyBucket={},this._lastUsedInitUrl=null,e&&(this._options=e),this._options.networkConfig&&(this._netConfig=this._options.networkConfig),this._netConfig.networkTimeoutMs&&(this._timeout=this._netConfig.networkTimeoutMs),this._fallbackResolver=new a.NetworkFallbackResolver(this._options),this.setLogEventCompressionMode(this._getLogEventCompressionMode(e))}setLogEventCompressionMode(e){this._options.logEventCompressionMode=e}setErrorBoundary(e){this._errorBoundary=e,this._errorBoundary.wrap(this),this._errorBoundary.wrap(this._fallbackResolver),this._fallbackResolver.setErrorBoundary(e)}isBeaconSupported(){return"undefined"!=typeof navigator&&"function"==typeof navigator.sendBeacon}getLastUsedInitUrlAndReset(){const e=this._lastUsedInitUrl;return this._lastUsedInitUrl=null,e}beacon(e){if(!k(e))return!1;const t=this._getInternalRequestArgs("POST",e),n=this._getPopulatedURL(t),o=navigator;return o.sendBeacon.bind(o)(n,t.body)}post(e){return o(this,void 0,void 0,(function*(){const t=this._getInternalRequestArgs("POST",e);return this._tryEncodeBody(t),yield this._tryToCompressBody(t),this._sendRequest(t)}))}get(e){const t=this._getInternalRequestArgs("GET",e);return this._sendRequest(t)}_sendRequest(e){var t,n,r,a;return o(this,void 0,void 0,(function*(){if(!k(e))return null;if(this._netConfig.preventAllNetworkTraffic)return null;const{method:u,body:d,retries:c,attempt:f}=e,g=e.urlConfig.endpoint;if(this._isRateLimited(g))return s.Log.warn(`Request to ${g} was blocked because you are making requests too frequently.`),null;const _=null!=f?f:1,p="undefined"!=typeof AbortController?new AbortController:null,b=setTimeout((()=>{null==p||p.abort(`Timeout of ${this._timeout}ms expired.`)}),this._timeout),w=this._getPopulatedURL(e);let E=null;const S=(0,h._isUnloading)();try{const n={method:u,body:d,headers:Object.assign({},e.headers),signal:null==p?void 0:p.signal,priority:e.priority,keepalive:S};!function(e,t){if(e.urlConfig.endpoint!==l.Endpoint._initialize)return;i.Diagnostics._markInitNetworkReqStart(e.sdkKey,{attempt:t})}(e,_);const o=this._leakyBucket[g];o&&(o.lastRequestTime=Date.now(),this._leakyBucket[g]=o);const r=null!==(t=this._netConfig.networkOverrideFunc)&&void 0!==t?t:fetch;if(E=yield r(w,n),clearTimeout(b),!E.ok){const e=yield E.text().catch((()=>"No Text")),t=new Error(`NetworkError: ${w} ${e}`);throw t.name="NetworkError",t}const s=yield E.text();return m(e,E,_,s),this._fallbackResolver.tryBumpExpiryTime(e.sdkKey,e.urlConfig),{body:s,code:E.status}}catch(t){const i=function(e,t){if((null==e?void 0:e.signal.aborted)&&"string"==typeof e.signal.reason)return e.signal.reason;if("string"==typeof t)return t;if(t instanceof Error)return`${t.name}: ${t.message}`;return"Unknown Error"}(p,t),l=(null==(C=p)?void 0:C.signal.aborted)&&"string"==typeof C.signal.reason&&C.signal.reason.includes("Timeout")||!1;m(e,E,_,"",t);if((yield this._fallbackResolver.tryFetchUpdatedFallbackInfo(e.sdkKey,e.urlConfig,i,l))&&(e.fallbackUrl=this._fallbackResolver.getActiveFallbackUrl(e.sdkKey,e.urlConfig)),!c||_>c||!y.has(null!==(n=null==E?void 0:E.status)&&void 0!==n?n:500)){null===(r=this._emitter)||void 0===r||r.call(this,{name:"error",error:t,tag:v.ErrorTag.NetworkError,requestArgs:e});const n=`A networking error occurred during ${u} request to ${w}.`;return s.Log.error(n,i,t),null===(a=this._errorBoundary)||void 0===a||a.attachErrorIfNoneExists(n),null}return yield function(e){return o(this,void 0,void 0,(function*(){yield new Promise((t=>setTimeout(t,Math.min(e*e*500,3e4))))}))}(_),this._sendRequest(Object.assign(Object.assign({},e),{retries:c,attempt:_+1}))}var C}))}_getLogEventCompressionMode(e){let t=null==e?void 0:e.logEventCompressionMode;return t||!0!==(null==e?void 0:e.disableCompression)||(t=p.LogEventCompressionMode.Disabled),t||(t=p.LogEventCompressionMode.Enabled),t}_isRateLimited(e){var t;const n=Date.now(),o=null!==(t=this._leakyBucket[e])&&void 0!==t?t:{count:0,lastRequestTime:n},r=n-o.lastRequestTime,i=Math.floor(.05*r);return o.count=Math.max(0,o.count-i),o.count>=50||(o.count+=1,o.lastRequestTime=n,this._leakyBucket[e]=o,!1)}_getPopulatedURL(e){var t;const n=null!==(t=e.fallbackUrl)&&void 0!==t?t:e.urlConfig.getUrl();e.urlConfig.endpoint!==l.Endpoint._initialize&&e.urlConfig.endpoint!==l.Endpoint._download_config_specs||(this._lastUsedInitUrl=n);const o=Object.assign({[l.NetworkParam.SdkKey]:e.sdkKey,[l.NetworkParam.SdkType]:d.SDKType._get(e.sdkKey),[l.NetworkParam.SdkVersion]:_.SDK_VERSION,[l.NetworkParam.Time]:String(Date.now()),[l.NetworkParam.SessionID]:f.SessionID.get(e.sdkKey)},e.params),r=Object.keys(o).map((e=>`${encodeURIComponent(e)}=${encodeURIComponent(o[e])}`)).join("&");return`${n}${r?`?${r}`:""}`}_tryEncodeBody(e){var t;const n=(0,c._getWindowSafe)(),o=e.body;if(e.isStatsigEncodable&&!this._options.disableStatsigEncoding&&"string"==typeof o&&null==(0,r._getStatsigGlobalFlag)("no-encode")&&(null==n?void 0:n.btoa))try{e.body=n.btoa(o).split("").reverse().join(""),e.params=Object.assign(Object.assign({},null!==(t=e.params)&&void 0!==t?t:{}),{[l.NetworkParam.StatsigEncoded]:"1"})}catch(t){s.Log.warn(`Request encoding failed for ${e.urlConfig.getUrl()}`,t)}}_tryToCompressBody(e){var t;return o(this,void 0,void 0,(function*(){const n=e.body;if("string"==typeof n&&function(e,t){if(!e.isCompressable)return!1;if(null!=(0,r._getStatsigGlobalFlag)("no-compress")||"undefined"==typeof CompressionStream||"undefined"==typeof TextEncoder)return!1;const n=null!=e.urlConfig.customUrl||null!=e.urlConfig.fallbackUrls,o=!0===u.SDKFlags.get(e.sdkKey,"enable_log_event_compression");switch(t.logEventCompressionMode){case p.LogEventCompressionMode.Disabled:return!1;case p.LogEventCompressionMode.Enabled:return!(n&&!o);case p.LogEventCompressionMode.Forced:return!0;default:return!1}}(e,this._options))try{const o=(new TextEncoder).encode(n),r=new CompressionStream("gzip"),i=r.writable.getWriter();i.write(o).catch(s.Log.error),i.close().catch(s.Log.error);const a=r.readable.getReader(),u=[];let d;for(;!(d=yield a.read()).done;)u.push(d.value);const c=u.reduce(((e,t)=>e+t.length),0),f=new Uint8Array(c);let g=0;for(const e of u)f.set(e,g),g+=e.length;e.body=f,e.params=Object.assign(Object.assign({},null!==(t=e.params)&&void 0!==t?t:{}),{[l.NetworkParam.IsGzipped]:"1"})}catch(t){s.Log.warn(`Request compression failed for ${e.urlConfig.getUrl()}`,t)}}))}_getInternalRequestArgs(e,t){const n=this._fallbackResolver.getActiveFallbackUrl(t.sdkKey,t.urlConfig),o=Object.assign(Object.assign({},t),{method:e,fallbackUrl:n});return"data"in t&&b(o,t.data),o}};const k=e=>!!e.sdkKey||(s.Log.warn("Unable to make request without an SDK key"),!1),b=(e,t)=>{const{sdkKey:n,fallbackUrl:o}=e,r=g.StableID.get(n),i=f.SessionID.get(n),s=d.SDKType._get(n);e.body=JSON.stringify(Object.assign(Object.assign({},t),{statsigMetadata:Object.assign(Object.assign({},_.StatsigMetadataProvider.get()),{stableID:r,sessionID:i,sdkType:s,fallbackUrl:o})}))};function m(e,t,n,o,r){e.urlConfig.endpoint===l.Endpoint._initialize&&i.Diagnostics._markInitNetworkReqEnd(e.sdkKey,i.Diagnostics._getDiagnosticsData(t,n,o,r))}},88655:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function l(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}a((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t._isDomainFailure=t.NetworkFallbackResolver=void 0;const r=n(58738),i=n(73529),s=n(49843),l=n(80893),a=6048e5;function u(e,t){var n;const o=null!==(n=null==e?void 0:e.toLowerCase())&&void 0!==n?n:"";return t||o.includes("uncaught exception")||o.includes("failed to fetch")||o.includes("networkerror when attempting to fetch resource")}function d(e){return`statsig.network_fallback.${(0,i._DJB2)(e)}`}function c(e,t){const n=d(e);t&&0!==Object.keys(t).length?l.Storage.setItem(n,JSON.stringify(t)):l.Storage.removeItem(n)}t.NetworkFallbackResolver=class{constructor(e){var t;this._fallbackInfo=null,this._errorBoundary=null,this._dnsQueryCooldowns={},this._networkOverrideFunc=null===(t=e.networkConfig)||void 0===t?void 0:t.networkOverrideFunc}setErrorBoundary(e){this._errorBoundary=e}tryBumpExpiryTime(e,t){var n;const o=null===(n=this._fallbackInfo)||void 0===n?void 0:n[t.endpoint];o&&(o.expiryTime=Date.now()+a,c(e,Object.assign(Object.assign({},this._fallbackInfo),{[t.endpoint]:o})))}getActiveFallbackUrl(e,t){var n,o;if(null!=t.customUrl&&null!=t.fallbackUrls)return null;let r=this._fallbackInfo;null==r&&(r=null!==(n=function(e){const t=d(e),n=l.Storage.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(e){return s.Log.error("Failed to parse FallbackInfo"),null}}(e))&&void 0!==n?n:{},this._fallbackInfo=r);const i=r[t.endpoint];return!i||Date.now()>(null!==(o=i.expiryTime)&&void 0!==o?o:0)||t.getChecksum()!==i.urlConfigChecksum?(delete r[t.endpoint],this._fallbackInfo=r,c(e,this._fallbackInfo),null):i.url?i.url:null}tryFetchUpdatedFallbackInfo(e,t,n,r){var i,s;return o(this,void 0,void 0,(function*(){try{if(!u(n,r))return!1;const o=null==t.customUrl&&null==t.fallbackUrls?yield this._tryFetchFallbackUrlsFromNetwork(t):t.fallbackUrls,s=this._pickNewFallbackUrl(null===(i=this._fallbackInfo)||void 0===i?void 0:i[t.endpoint],o);return!!s&&(this._updateFallbackInfoWithNewUrl(e,t,s),!0)}catch(e){return null===(s=this._errorBoundary)||void 0===s||s.logError("tryFetchUpdatedFallbackInfo",e),!1}}))}_updateFallbackInfoWithNewUrl(e,t,n){var o,r,i;const s={urlConfigChecksum:t.getChecksum(),url:n,expiryTime:Date.now()+a,previous:[]},l=t.endpoint,u=null===(o=this._fallbackInfo)||void 0===o?void 0:o[l];u&&s.previous.push(...u.previous),s.previous.length>10&&(s.previous=[]);const d=null===(i=null===(r=this._fallbackInfo)||void 0===r?void 0:r[l])||void 0===i?void 0:i.url;null!=d&&s.previous.push(d),this._fallbackInfo=Object.assign(Object.assign({},this._fallbackInfo),{[l]:s}),c(e,this._fallbackInfo)}_tryFetchFallbackUrlsFromNetwork(e){var t;return o(this,void 0,void 0,(function*(){const n=this._dnsQueryCooldowns[e.endpoint];if(n&&Date.now()<n)return null;this._dnsQueryCooldowns[e.endpoint]=Date.now()+144e5;const o=[],i=yield(0,r._fetchTxtRecords)(null!==(t=this._networkOverrideFunc)&&void 0!==t?t:fetch),s=function(e){try{return new URL(e).pathname}catch(e){return null}}(e.defaultUrl);for(const t of i){if(!t.startsWith(e.endpointDnsKey+"="))continue;const n=t.split("=");if(n.length>1){let e=n[1];e.endsWith("/")&&(e=e.slice(0,-1)),o.push(`https://${e}${s}`)}}return o}))}_pickNewFallbackUrl(e,t){var n;if(null==t)return null;const o=new Set(null!==(n=null==e?void 0:e.previous)&&void 0!==n?n:[]),r=null==e?void 0:e.url;let i=null;for(const e of t){const t=e.endsWith("/")?e.slice(0,-1):e;if(!o.has(e)&&t!==r){i=t;break}}return i}},t._isDomainFailure=u},54462:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},46386:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},94082:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SDKFlags=void 0;const n={};t.SDKFlags={setFlags:(e,t)=>{n[e]=t},get:(e,t)=>{var o,r;return null!==(r=null===(o=n[e])||void 0===o?void 0:o[t])&&void 0!==r&&r}}},39561:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SDKType=void 0;const n={};let o;t.SDKType={_get:e=>{var t;return(null!==(t=n[e])&&void 0!==t?t:"js-mono")+(null!=o?o:"")},_setClientType(e,t){n[e]=t},_setBindingType(e){o&&"-react"!==o||(o="-"+e)}}},82487:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._getUnloadEvent=t._getCurrentPageUrlSafe=t._addDocumentEventListenerSafe=t._addWindowEventListenerSafe=t._isServerEnv=t._getDocumentSafe=t._getWindowSafe=void 0;t._getWindowSafe=()=>"undefined"!=typeof window?window:null;t._getDocumentSafe=()=>{var e;const n=(0,t._getWindowSafe)();return null!==(e=null==n?void 0:n.document)&&void 0!==e?e:null};t._isServerEnv=()=>{if(null!==(0,t._getDocumentSafe)())return!1;const e="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node;return"string"==typeof EdgeRuntime||e};t._addWindowEventListenerSafe=(e,n)=>{const o=(0,t._getWindowSafe)();"function"==typeof(null==o?void 0:o.addEventListener)&&o.addEventListener(e,n)};t._addDocumentEventListenerSafe=(e,n)=>{const o=(0,t._getDocumentSafe)();"function"==typeof(null==o?void 0:o.addEventListener)&&o.addEventListener(e,n)};t._getCurrentPageUrlSafe=()=>{var e;try{return null===(e=(0,t._getWindowSafe)())||void 0===e?void 0:e.location.href.split(/[?#]/)[0]}catch(e){return}};t._getUnloadEvent=()=>{const e=(0,t._getWindowSafe)();if(!e)return"beforeunload";return"onpagehide"in e?"pagehide":"beforeunload"}}}]);
//# sourceMappingURL=https://www.scribd.com/webpack/monolith/6248.c7157169e86cb503e7cc.js.map